(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[894],{53758:function(e,t,n){"use strict";n.d(t,{j:function(){return d}});var r=n(91229),o=n(38347),i=n(67294),a=n(41120),s=n(282),c=n(86010),l=i.createElement,u=(0,a.Z)((function(e){return{warning:{backgroundColor:e.palette.warning.main,color:e.palette.getContrastText(e.palette.warning.main)},altWarning:{backgroundColor:e.palette.warning.main,color:e.palette.common.white},error:{backgroundColor:e.palette.error.main,color:e.palette.getContrastText(e.palette.error.main)}}})),d=i.forwardRef((function(e,t){var n=e.children,i=e.disabled,a=e.color,d=e.className,p=(0,o.Z)(e,["children","disabled","color","className"]),f=u(),g={warning:f.warning,error:f.error,altWarning:f.altWarning}[a];return l(s.Z,(0,r.Z)({color:g?void 0:a,disabled:i,className:(0,c.Z)(g,d)},p,{innerRef:t}),n)}))},95597:function(e,t,n){"use strict";n.d(t,{X:function(){return F}});var r=n(59999),o=n(91229),i=n(67294),a=n(41120),s=n(44845),c=n(39803),l=n(41749),u=n(94179),d=n(73155),p=n(44689),f=n(18463),g=n(51907),m=n(79912),v=n(22318),h=n(951),b=n(13258),y=i.createElement,k=(0,a.Z)((function(e){return{root:{minWidth:140},bullet:{display:"inline-block",margin:"0 2px",transform:"scale(0.8)"},title:{fontSize:14},pos:{marginBottom:12},media:{height:70,objectFit:"scale-down"},contentRoot:{paddingBottom:e.spacing(0)},actionsRoot:{paddingTop:e.spacing(0),justifyContent:"center"}}}));function x(e){var t=e.image,n=void 0===t?"/static/images/cards/contemplative-reptile.jpg":t,r=e.title,o=e.onChange,i=k();y("span",{className:i.bullet},"\u2022");return y(f.Z,{className:i.root},y(h.Z,{className:i.media,image:n,title:"Contemplative Reptile"}),y(m.Z,{className:i.contentRoot},y(u.x,{variant:"h5",gutterBottom:!0,component:"h2"},r),y(v.Z,{variant:"body2",component:"p"})),y(g.Z,{className:i.actionsRoot},y(b.Z,{size:"small",style:{alignSelf:"center"},onChange:function(e){o(e.target.checked)}})))}var Z=(0,a.Z)((function(e){return{gridParent:{},gridRoot:{}}})),w={0:"https://i.imgur.com/h1hxfeh.png",.2:"https://i.imgur.com/Qt0PdUk.png",.4:"https://i.imgur.com/dOEItFX.png",.6:"https://i.imgur.com/SVEAbnc.png",.8:"https://i.imgur.com/h1hxfeh.png",1:"https://i.imgur.com/Qt0PdUk.png"},C={L:"https://i.imgur.com/h1hxfeh.png",podium:"https://i.imgur.com/Qt0PdUk.png",tower:"https://i.imgur.com/dOEItFX.png",toroid:"https://i.imgur.com/SVEAbnc.png"};function j(){return function(e){var t=Object.keys(e);return e[t[t.length*Math.random()<<0]]}(C)}function O(e){var t,n=e.fieldInfo,o=e.setFilterMap,i=e.filterMap,a=Z(),s=(null===(t=i.get(n.fieldUniqueName))||void 0===t?void 0:t.value)||[];return console.log("currentCheckedOptions"),console.log(s),y("div",{className:a.gridParent},y(u.x,{variant:"h5"},n.fieldUniqueName),y(l.Z,{container:!0,spacing:3,className:a.gridRoot},n.options.map((function(e){var t=s.find((function(t){return t===e}));return y(l.Z,{key:e,item:!0},y(x,{image:w[e]||j(),title:e,checked:t,onChange:function(a){t!==a&&function(e,t){var a=new Map(i);if(t){var c=[].concat((0,r.Z)(s),[e]);a.set(n.fieldUniqueName,{fieldType:n.fieldType,value:c})}else{var l=s.filter((function(t){return t!==e}));0!==l.length?a.set(n.fieldUniqueName,{fieldType:n.fieldType,value:l}):a.set(n.fieldUniqueName,void 0)}o(a)}(e,a)}}))}))))}var P=i.createElement,S=(0,a.Z)((function(e){return{root:{width:"100%"}}}));function E(e){var t,n=e.key,r=e.fieldInfo,o=e.setFilterMap,a=e.filterMap,c=S(),l=r.min!==r.max?r.min:r.min-1,d=r.min!==r.max?r.max:r.min+1,p=(null===(t=a.get(r.fieldUniqueName))||void 0===t?void 0:t.value)||[r.min,r.max],f=(0,i.useState)(p),g=f[0],m=f[1];(0,i.useEffect)((function(){var e,t=(null===(e=a.get(r.fieldUniqueName))||void 0===e?void 0:e.value)||[r.min,r.max];m(t)}),[a]);var v=r.fieldUniqueName+"-manual-slider",h=[{value:l,label:l.toFixed(2)},{value:d,label:d.toFixed(2)}];return P("div",{key:n,className:c.root},P(u.Z,{id:v,gutterBottom:!0,variant:"h5"},r.fieldUniqueName),P(s.Z,{onChange:function(e,t){m(t)},onChangeCommitted:function(e,t){if(2===t.length){var n=new Map(a),i={fieldType:r.fieldType,fieldUniqueName:r.fieldUniqueName,value:t};"number"===r.fieldType&&(i.min=t[0],i.max=t[1]),n.set(r.fieldUniqueName,i),o(n)}else console.error("single value returned")},value:g,getAriaValueText:function(){return p[0]+" to "+p[1]},"aria-labelledby":v,min:l,step:.001,max:d,valueLabelDisplay:"auto",valueLabelFormat:function(e){return e.toFixed(2)},marks:h}))}function I(e){var t,n=e.key,r=e.fieldInfo,a=e.setFilterMap,s=e.filterMap,l=(null===(t=s.get(r.fieldUniqueName))||void 0===t?void 0:t.value)||[];return P(i.Fragment,null,P(d.ZP,{key:n,multiple:!0,fullWidth:!0,filterSelectedOptions:!0,getOptionSelected:function(e,t){return e===t},value:l,onChange:function(e,t){var n=new Map(s);n.set(r.fieldUniqueName,{fieldType:r.fieldType,value:t}),a(n)},options:r.options,renderInput:function(e){return P(c.Z,(0,o.Z)({},e,{variant:"standard",label:r.fieldUniqueName,placeholder:"Select options to include"}))}}))}var N={"in:HP Fraction":1,shape:2};var T=(0,a.Z)((function(e){return{}}));function F(e){var t=e.version,n=e.filterMap,o=e.setFilterMap,i=T(),a=(0,p.uW)(),s=(0,p.GC)();return P(l.Z,{container:!0,direction:"row",spacing:3,alignItems:"flex-start",justify:"center"},P(l.Z,{xs:8,item:!0}),P(l.Z,{xs:4,item:!0,container:!0,direction:"row-reverse"}),t&&t.fieldInfo&&(0,r.Z)(t.fieldInfo).sort((function(e,t){return r=t,o=!(a||s),"number"===(n=e).fieldType&&"number"!==r.fieldType?o?-1:1:"number"!==n.fieldType&&"number"===r.fieldType?o?1:-1:0;var n,r,o})).map((function(e){var t=0,r=1,a=2,s=3,c="number"===e.fieldType?r:(N[e.fieldUniqueName]?(console.log(!0),1):(console.log(!1),0))?s:"text"===e.fieldType?a:t;return P(l.Z,{item:!0,container:!0,xs:11,key:e.fieldUniqueName,className:i.listItem},c===r&&P(E,{key:e.fieldUniqueName,fieldInfo:e,filterMap:n,setFilterMap:o}),c===a&&P(I,{key:e.fieldUniqueName,fieldInfo:e,filterMap:n,setFilterMap:o}),c===s&&P(O,{key:e.fieldUniqueName,fieldInfo:e,filterMap:n,setFilterMap:o}))})))}},40660:function(e,t,n){"use strict";n.d(t,{Z:function(){return Q}});var r=n(59999),o=n(64121),i=n(67294),a=n(26265),s=n(20764),c=function(e){var t=[],n=1e3,r=function(){},o=function(){},i=function e(t){t&&e.data(t),r(),o(),e.render()};i.render=function(){var o=!0;r=i.invalidate=function(){o=!1},function r(){if(!o)return!0;t.splice(0,n).map(e),a(r)}()},i.data=function(e){return r(),t=e.slice(0),i},i.add=function(e){t=t.concat(e)},i.rate=function(e){return arguments.length?(n=e,i):n},i.remaining=function(){return t.length},i.clear=function(e){return arguments.length?(o=e,i):(o(),i)},i.invalidate=r;var a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,17)};return i};function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d={curveLinear:s.c_6,curveMonotoneX:s.FdL,curveMonotoneY:s.ak_,curveStep:s.eA_},p={interpolateCubehelixDefault:s.yBY,interpolateCool:s.vcY,interpolateInferno:s.sN9,interpolatePlasma:s.iAt,interpolateTurbo:s._BJ,interpolateMagma:s.Gii,interpolateSpectral:s.T0$,interpolateRainbow:s.ICD},f=function(e,t){var n=t.map((function(t){var n=e.domains.get(t.fieldUniqueName);if(n){var r=e.isVertical?s.BYU().range([e.getWidth()-e.margin.right,e.margin.right]):s.BYU().range([e.height,e.margin.top]);return r.domain(n),u(u({},t),{},{domain:n,scale:r})}}));e.x=e.isVertical?new Map(Array.from(n.map((function(e){return e})),(function(e){return[e.fieldUniqueName,e]}))):s.q2y(n.map((function(e){return e.fieldUniqueName})),[e.margin.left,e.getWidth()-e.margin.right]),e.y=e.isVertical?s.q2y(n.map((function(e){return e.fieldUniqueName})),[e.margin.top,e.height-e.margin.bottom]):new Map(Array.from(n.map((function(e){return e})),(function(e){return[e.fieldUniqueName,e]})));var r=p[e.color]||s.yBY;e.z=e.isVertical?s.cJy(e.x.get(e.shader).scale.domain(),(function(e){return r(1-e)})):s.cJy(e.y.get(e.shader).scale.domain(),(function(e){return r(1-e)}))},g=function(e){var t=e.initDimensions.map((function(t){return{key:t.fieldUniqueName,position:e.isVertical?e.y([t.fieldUniqueName]):e.x([t.fieldUniqueName])}}));e.svg.attr("width",e.getWidth()),s.td_(".dimension").data(t).attr("transform",(function(t){return e.isVertical?"translate(0, ".concat(t.position,")"):"translate(".concat(t.position,", 0)")})),s.td_(".dimension").each((function(t){t.key&&(s.Ys(this).call(e.isVertical?s.LLu(e.x.get(t.key).scale).ticks(5):s.Khx(e.y.get(t.key).scale)),s.Ys(this).call((function(t){return t.selectAll("text").attr("font-size",e.fontSize)})))}))},m=function(e,t,n,r){e.foreground.clearRect(0,0,e.getWidth(),e.height);var i=e.isVertical?s.jvg().defined((function(e){return null!=(0,o.Z)(e,2)[1]})).curve(e.curve).context(e.foreground).x((function(t){var n=(0,o.Z)(t,2),r=n[0],i=n[1];return e.x.get(r).scale(i)})).y((function(t){var r=(0,o.Z)(t,1)[0];return r===n?e.y(r)+n.y:e.y(r)})):s.jvg().defined((function(e){return null!=(0,o.Z)(e,2)[1]})).curve(e.curve).context(e.foreground).y((function(t){var n=(0,o.Z)(t,2),r=n[0],i=n[1];return e.y.get(r).scale(i)})).x((function(t){var r=(0,o.Z)(t,1)[0];return r===n?e.x(r)+n.x:e.x(r)}));c((function(t){var n,o;e.foreground.globalCompositeOperation="darken",e.foreground.lineWidth=e.lineWidth,e.foreground.strokeStyle=(n=e.z(t[e.shader]),o=r?.005:1,"rgba".concat(null===n||void 0===n?void 0:n.substring(null===n||void 0===n?void 0:n.indexOf("("),null===n||void 0===n?void 0:n.indexOf(")")),", ").concat(o,")")),r&&r._id===t._id&&(e.foreground.strokeStyle="grey",e.foreground.lineWidth=8),e.foreground.beginPath(),i(s.kCc(e.sorted.map((function(e){return e.fieldUniqueName})),[t],(function(e,t){return[e,t[e]]}))),e.foreground.stroke()})).rate(100)(t)},v=function(e){e.svg.selectAll(".brush").each((function(t){var n=e.brushed.get(t);if(s.Ys(this).call(e.brush.move,null),n){var r=e.isVertical?e.x.get(t):e.y.get(t);s.Ys(this).call(e.brush.move,[r.scale(n[0]),r.scale(n[1])])}}))},h=function(e){var t=e.pc,n=e.height,r=e.margin,o=function(e,n){if(e.sourceEvent){if(null===e.selection)t.brushed.delete(n);else{var r=(t.isVertical?t.x.get(n):t.y.get(n)).scale.invert;t.brushed.set(n,[r(e.selection[0]),r(e.selection[1])])}t.onBrush(t.brushed)}};return e.isVertical?s.Yud().extent([[r.left-15,-15],[t.getWidth()+50,15]]).on("start brush end",o):s.Lae().extent([[-15,r.top-15],[15,n-r.bottom+15]]).on("start brush",o)},b=function(e){var t=e.pc,n=e.isVertical,r={},o=function(e){var o=r[e];return null==o?n?t.y(e):t.x(e):o};return s.ohM().on("start",(function(e,o){!function(e,o,i){r[o]=n?t.y(o):t.x(o)}(0,o)})).on("drag",(function(e,i){!function(e,i,a){r[i]=n?Math.min(t.height,Math.max(0,t.y(i)+e.y)):Math.min(t.getWidth(),Math.max(0,t.x(i)+e.x)),s.Ys(a).attr("transform",(function(t){return n?"translate(0, ".concat(e.y,")"):"translate(".concat(e.x,", 0)")})),t.sorted.sort((function(e,t){return o(e.fieldUniqueName)-o(t.fieldUniqueName)}))}(e,i,this)})).on("end",(function(e,o){!function(e,o,i){n?t.y.domain(t.sorted.map((function(e){return e.fieldUniqueName}))):t.x.domain(t.sorted.map((function(e){return e.fieldUniqueName}))),delete r[o],s.Ys(i).attr("transform",(function(e){return"translate(0,0)"})),m(t,t.data),g(t,t.sorted),t.onSort(t.sorted)}(0,o,this)}))},y=function(e){var t=e.container,n=e.width,o=e.height,i=e.margin,a=e.shader,c=e.dimensions,l=e.isVertical,u=e.onBrush,p=e.onSort,y="0.75rem",k={};return k.fontSize=y,k.lineWidth=2.5,k.isVertical=l,k.container=t,k.width=n,k.height=o,k.margin=i,k.curve=s.c_6,k.onBrush=u,k.onSort=p,k.brushed=new Map,k.initDimensions=c,k.sorted=(0,r.Z)(k.initDimensions),k.shader=a,k.domains=new Map,k.initDimensions.forEach((function(e){k.domains.set(e.fieldUniqueName,[e.max,e.min])})),k.getWidth=function(){return k.width},k.svg=k.container.select("svg"),k.container.selectAll(".dimension").remove(),k.svg.attr("width",k.getWidth()).attr("height",k.height+k.margin.top+k.margin.bottom),k.foreground=k.container.select("canvas").attr("width",k.getWidth()).attr("height",k.height+k.margin.top+k.margin.bottom).node().getContext("2d"),k.brush=h({pc:k,height:o,margin:i,isVertical:l}),k.drag=b({pc:k,margin:i,height:o,isVertical:l}),k.svg.append("g").selectAll("g").data(k.initDimensions.map((function(e){return e.fieldUniqueName}))).join("g").attr("class","dimension"),k.svg.selectAll(".dimension").append("g").attr("class","brush").each((function(e){s.Ys(this).call(k.brush)})),k.svg.selectAll(".dimension").append("g").call(k.drag,undefined).attr("class","axis").call((function(e){return e.append("text").attr("x",l?i.left:i.top-50).attr("y",-10).attr("text-anchor",l?"start":"end").attr("font-size",y).attr("fill","currentColor").attr("class","label").text((function(e){return e.toUpperCase()})).attr("transform",l?"":"rotate(270, 0, 0)")})),k.unload=function(){k&&k.svg||k.svg.selectAll("*").remove()},k.draw=function(e,t,n,r,o,i,a,c,l){var u=k.container.select("svg");u&&(k.width=e,k.height=t,k.curve=d[n]||s.c_6,k.lineWidth=o,k.data=i,k.color=r,k.shader=c,f(k,k.sorted),u.attr("width",k.getWidth()),u.attr("height",k.height+k.margin.top+k.margin.bottom),k.container.select("canvas").attr("width",k.getWidth()),k.brushed=a,v(k),m(k,k.data,null,l),g(k,k.sorted))},k},k=n(41120),x=n(8920),Z=n(17812),w=n(59009),C=n(41749),j=n(868),O=n(22318),P=n(14670),S=n(72755),E=n(77655),I=n(85639),N=n(52303),T=n(76861),F=n(22393),D=n(26433),R=n(33320),B=n(78966),q=n(58840),A=n(20563),M=n(2804),W=["curveMonotoneX","curveMonotoneY","curveLinear","curveStep"],_=(0,M.cn)({key:"curveAtom",default:W[0]});var U=["interpolateCubehelixDefault","interpolateCool","interpolateTurbo","interpolateSpectral","interpolateRainbow"],V=(0,M.cn)({key:"colorAtom",default:U[2]});var H=[1,2,3,4,5],L=(0,M.cn)({key:"lineWidthAtom",default:H[1]});n(86817),(0,M.cn)({key:"shaderAtom",default:null});var z=i.createElement;var G,Y=(0,k.Z)((function(e){return{chart:{display:"block",position:"relative"},label:{cursor:"move"},canvas:{position:"absolute"},svg:{position:"absolute"},card:{width:"100%",marginBottom:e.spacing(2)},cardHeader:{marginTop:0,marginBottom:0},cardSubHeader:{marginTop:0,marginBottom:0},formControl:{margin:e.spacing(1),minWidth:120},grid:{padding:e.spacing(3)},paper:{padding:e.spacing(3),marginTop:e.spacing(3)},stickyItem:{top:0,position:"sticky"}}})),Q=((0,P.Z)((function(e){return{badge:{right:-1,top:13,border:"2px solid ".concat(e.palette.background.paper),padding:"0 4px"}}}))(w.Z),function(e){var t=Y(),n=(0,x.Z)(),r=e.isVertical,a=(e.dataset,e.dimensions),c=e.data,l=e.width,u=e.height||75*a.length,d=e.hovered;console.log("dimensions"),console.log(a);var p=function(){var e=(0,M.FV)(_),t=(0,o.Z)(e,2);return[t[0],t[1]]}(),f=(0,o.Z)(p,2),g=f[0],m=f[1],v=i.useState(null),h=(0,o.Z)(v,2),b=h[0],k=h[1],w=function(){var e=(0,M.FV)(V),t=(0,o.Z)(e,2);return[t[0],t[1]]}(),P=(0,o.Z)(w,2),Q=P[0],J=P[1],X=i.useState(null),$=(0,o.Z)(X,2),K=$[0],ee=$[1],te=function(){var e=(0,M.FV)(L),t=(0,o.Z)(e,2);return[t[0],t[1]]}(),ne=(0,o.Z)(te,2),re=ne[0],oe=ne[1],ie=i.useState(null),ae=(0,o.Z)(ie,2),se=ae[0],ce=ae[1],le=i.useState(a[0].fieldUniqueName),ue=(0,o.Z)(le,2),de=ue[0],pe=ue[1],fe=i.useState(null),ge=(0,o.Z)(fe,2),me=ge[0],ve=ge[1],he=(0,B.v)(),be=(0,o.Z)(he,2),ye=(be[0],be[1],(0,A.v)()),ke=(0,o.Z)(ye,2),xe=ke[0],Ze=ke[1],we=(0,q.UV)(),Ce=(0,o.Z)(we,2),je=(Ce[0],Ce[1]),Oe=function(e){Ze(new Map(e)),je(0)},Pe=function(e){},Se={top:n.spacing(7),right:25,bottom:n.spacing(0),left:25},Ee=(0,i.useRef)();return(0,i.useEffect)((function(){var e=s.Ys(Ee.current);e&&(G=new y({container:e,width:l,height:u,margin:Se,shader:de,dimensions:a,isVertical:r,curve:g,onBrush:Oe,onSort:Pe}));return function(){G&&G.unload(e)}}),[]),(0,i.useEffect)((function(){c&&G&&G.draw(l,u,g,Q,re,c,xe,de,d)}),[l,u,g,Q,re,c,de,xe]),z("div",{className:t.stickyItem},z(C.Z,{container:!0},z(C.Z,{xs:5,item:!0},z(j.ZP,{title:"Clear brushed dimensions",arrow:!0},z("span",null,z(Z.Z,{"aria-controls":"simple-menu2","aria-haspopup":"true",onClick:function(){Ze(new Map)},disabled:0===xe.size},z(F.Z,null)))),z(O.Z,{variant:"overline",display:"inline",gutterBottom:!0,style:{fontWeight:400,lineHeight:1.66}},xe.size," brushes - ",null===c||void 0===c?void 0:c.length," rows")),z(C.Z,{xs:7,item:!0,container:!0,direction:"row-reverse"},z(j.ZP,{title:"Apply color palette by dimension",arrow:!0},z(Z.Z,{"aria-controls":"simple-menu2","aria-haspopup":"true",onClick:function(e){ve(e.currentTarget)}},z(R.Z,null))),z(E.Z,{id:"simple-menu2",anchorEl:me,keepMounted:!0,open:Boolean(me),onClose:function(e){ve(null)}},a.map((function(e){return e.fieldUniqueName})).map((function(e){return z(I.Z,{key:e,selected:e===de,onClick:function(t){return function(e,t){pe(t)}(0,e)}},e)}))),z(j.ZP,{title:"Apply color palette",arrow:!0},z(Z.Z,{"aria-controls":"simple-menu2","aria-haspopup":"true",onClick:function(e){ee(e.currentTarget)}},z(T.Z,null))),z(E.Z,{id:"simple-menu2",anchorEl:K,keepMounted:!0,open:Boolean(K),onClose:function(e){ee(null)}},U.map((function(e,t){return z(I.Z,{key:e,selected:t===U.indexOf(Q),onClick:function(e){return function(e,t){J(U[t])}(0,t)}},e)}))),z(j.ZP,{title:"Apply line paths",arrow:!0},z(Z.Z,{"aria-controls":"simple-menu1","aria-haspopup":"true",onClick:function(e){k(e.currentTarget)}},z(N.Z,null))),z(E.Z,{id:"simple-menu1",anchorEl:b,keepMounted:!0,open:Boolean(b),onClose:function(e){k(null)}},W.map((function(e,t){return z(I.Z,{key:e,selected:t===W.indexOf(g),onClick:function(e){return function(e,t){m(W[t])}(0,t)}},e)}))),z(j.ZP,{title:"Apply line weights",arrow:!0},z(Z.Z,{"aria-controls":"simple-menu3","aria-haspopup":"true",onClick:function(e){ce(e.currentTarget)}},z(D.Z,null))),z(E.Z,{id:"simple-menu2",anchorEl:se,keepMounted:!0,open:Boolean(se),onClose:function(e){ce(null)}},H.map((function(e,t){return z(I.Z,{key:e,selected:t===H.indexOf(re),onClick:function(e){return function(e,t){oe(H[t])}(0,t)}},e)})))),z(C.Z,{item:!0,xs:12},c&&z(S.Z,null,(function(e){return z("div",{id:"chart",ref:Ee,className:t.chart,style:{height:u+Se.top+Se.bottom}},z("canvas",{className:t.canvas}),z("svg",{className:t.svg}))})))))})},85835:function(e,t,n){"use strict";n.d(t,{k:function(){return lt},Z:function(){return ut}});var r=n(809),o=n.n(r),i=n(26265),a=n(92447),s=n(64121),c=n(40616),l=n(91229),u=n(67294),d=n(72755),p=n(12236),f=n(41749),g=n(41120),m=n(43832),v=n(282),h=n(77655),b=n(73637),y=n(85639),k=n(868),x=n(95477),Z=n(18463),w=n(79912),C=n(40660),j=n(94697),O=n(22318),P=n(17812),S=n(90641),E=n(77202),I=n(89659),N=n(33901),T=u.createElement,F=(0,g.Z)((function(e){return{root:function(e){return{maxWidth:e.maxWidth,border:"none",boxShadow:"none",borderRadius:9}},link:{"&:hover":{textDecoration:"none",color:e.palette.dlg.grey}},cardMedia:{borderRadius:9},cardHeader:{alignItems:"flex-start"},cardHeaderAction:{alignSelf:"center"},cardActions:{paddingLeft:11.5},cardContent:{paddingBottom:e.spacing(0)},description:{marginTop:0,marginBottom:0,display:"block"},rounded:{width:e.spacing(7),height:e.spacing(7)},icons:{marginLeft:"auto"}}}));function D(e){var t=e.metric,n=e.value,r=e.image,o=e.isBookmarked,i=e.onBookmarkClick,a=e.onShowMoreClick,s=e.warningText,c=F({maxWidth:"100%"});return T(Z.Z,{className:c.root,variant:"outlined"},T(j.Z,{className:c.cardHeader,avatar:T(u.Fragment,null,r&&T(N.Z,{variant:"rounded",className:c.rounded,src:r.url}),!r&&T(N.Z,{variant:"rounded",color:"primary",className:c.rounded},T(S.Z,null))),title:T(I.Z,{component:"button",color:"secondary",className:c.link,variant:"h4",onClick:a},T(O.Z,{variant:"h4",display:"block",gutterBottom:!0,style:{margin:0}},n)),subheader:T(u.Fragment,null,T(O.Z,{variant:"overline",display:"block",gutterBottom:!0,style:{fontWeight:300,lineHeight:1.66}},t),s&&T(O.Z,{variant:"overline",color:"warning",display:"block",gutterBottom:!0,style:{fontWeight:300,lineHeight:1.66}},s)),action:T(u.Fragment,null,T(k.ZP,{title:"Bookmark this datarow",arrow:!0},T(P.Z,{"aria-label":"show more",onClick:i},T(E.Z,{color:o?"secondary":"inherit"}))))}))}var R=n(44689),B=n(86817),q=n(97352),A=n(78966),M=n(6546),W=n(58840),_=n(29273),U=n(86010),V=(n(16005),n(9108)),H=n(33454),L=n(48302),z=n(99988),G=u.createElement;function Y(e){var t=e.open,n=e.onCancelled,r=e.onConfirmed,o=e.saving,i=e.error,a=e.existingFilterSet,s=(0,R.uW)(),c=null;c=s?"What would you like to call your Predesign configuration?":a?"Are you sure you want to overwrite the current FilterSet?":"Would you like to save your current FilterSet?";var l=s?"Save Predesign Configuration":"Save FilterSet";return G(z.mQ,{open:t,onCancelled:n,onConfirmed:function(e){r(a||{name:e})},message:c,title:l,confirmText:a?"Overwrite":"Save",confirmColor:a?"warning":"primary",cancelText:"Cancel",inProgress:o,includeSpacer:!0,error:i,textFieldLabel:"Name",requireTextEntry:!a,textFieldValue:a?a.name:null,textFieldInputProps:{maxLength:50}})}function Q(e){var t=e.open,n=e.onCancelled,r=e.onConfirmed,o=e.selectedFilterName;return G(z.mQ,{open:t,onCancelled:n,onConfirmed:r,title:"Change Filter Set",message:"Are you sure you want to apply the filter set ".concat(o,"? You'll lose any unsaved changes."),confirmText:"Confirm",confirmColor:"warning",includeSpacer:!0})}function J(e){var t=e.open,n=e.onCancelled,r=e.onConfirmed;return G(z.mQ,{open:t,message:"Are you sure you want to delete this dataset?",title:"Delete Dataset",onConfirmed:r,onXButton:n,onCancelled:n,confirmText:"Confirm Deletion",confirmColor:"warning",cancelColor:"default",cancelText:"Cancel",includeSpacer:!0})}function X(e){var t=e.open,n=e.onCancelled,r=e.onConfirmed;e.existingFilterSet;return G(z.mQ,{open:t,message:"Are you sure you want to delete this filter set?",title:"Delete FilterSet",onConfirmed:r,onXButton:n,onCancelled:n,confirmText:"Confirm Deletion",confirmColor:"warning",cancelColor:"default",cancelText:"Cancel",includeSpacer:!0})}var $=n(58365),K=n(35308),ee=n(53093),te=n(94179),ne=n(84176),re=n(59999),oe=n(39803),ie=n(96733),ae=n(73155),se=(n(73935),u.createElement);function ce(e){var t=e.options,n=e.onChange,r=e.selected,o=e.onDeleteOption,i=[{name:"New",_id:"new"}].concat((0,re.Z)(t));return se("div",{style:{marginRight:8}},se(ae.ZP,{id:"dataset-select",options:i,getOptionLabel:function(e){return e.name},getOptionSelected:function(e,t){return e._id===t._id},autoHighlight:!0,autoComplete:!0,style:{width:200},renderInput:function(e){return se(oe.Z,(0,l.Z)({},e,{label:"Filter Sets",variant:"outlined"}))},renderOption:function(e){return se(f.Z,{container:!0,justifyContent:"space-between",alignItems:"center",style:{margin:"0px",padding:"0px",overflow:"hidden"}},e.name,"new"!==e._id&&se(P.Z,{size:"small",edge:"end",onClick:function(t){t.stopPropagation(),t.preventDefault(),o&&(console.log(e),o({filterSetId:e._id}))}},se(ie.Z,null)))},onChange:function(e,t){e.preventDefault(),console.log(t),n(t)},value:r}))}var le=n(96912),ue=n(81146),de=n(44562),pe=(n(29681),n(14670)),fe=n(29525),ge=n(92863),me=n(2208),ve=n(95597),he=u.createElement,be=(0,pe.Z)((function(e){return{root:{padding:e.spacing(2),overflow:"visible"}}}))(fe.Z),ye=(0,g.Z)((function(e){var t=function(e){return e.palette.background.paper}(e);return{messageBox:{paddingLeft:e.spacing(3),paddingRight:e.spacing(3),marginTop:e.spacing(3),paddingTop:e.spacing(3),background:t,backgroundClip:"padding-box",paddingBottom:e.spacing(2),borderRadius:"10px 10px 0px 0px",color:e.palette.getContrastText(e.palette.background.paper)},countLabel:{fontWeight:400,color:e.palette.getContrastText(e.palette.background.paper)},countBox:{position:"sticky",top:"64px",width:"100%",zIndex:101,background:t,backgroundClip:"padding-box",marginTop:e.spacing(3),marginBottom:e.spacing(3)},labelIcon:{verticalAlign:"middle"},warningColor:{color:e.palette.warning.main},disabledColor:{color:e.palette.action.disabled},contentRoot:{textAlign:"center"}}}));function ke(e){var t,n=e.open,r=e.count,o=e.onCancelled,a=e.error,s=e.countInProgress,c=e.limitExceeded,l=e.limit,u=e.isVertical,d=e.version,p=e.filterMap,f=e.setFilterMap,g=ye(),m=(0,R.uW)();return he(me.kH,{onClose:o,"aria-label":"pre-filter-dialog",open:n},he(z.$N,{id:"customized-dialog-title",onClose:o},m?"Configure Your Building":"Pre-Filters"),he(be,{className:g.contentRoot},he(te.Z,{variant:"overline",display:"block",gutterBottom:!0,style:{fontWeight:300,lineHeight:1.66}},m&&"Let's start limiting options by configurating some of the main properties of your building.",c&&!m&&"This dataset is currently a little too big to browse, let's start by locking in some prefilters until we can get below ".concat(l," options."),!c&&!m&&"You can use these prefilters to hide options that you know you're not interested in."),he("div",{className:g.countBox},he(te.Z,{className:g.countLabel,component:"span"},"Current option count: "," ",s?he(ge.Z,{color:"disabled",className:g.labelIcon},"search"):c?he(ge.Z,{className:(0,U.Z)([g.labelIcon,g.warningColor])},"error"):he(ge.Z,{color:"primary",className:g.labelIcon},"checkCircle"),!s&&he(te.Z,{display:"inline",variant:"h4",component:"p",color:"primary",className:(0,U.Z)((t={},(0,i.Z)(t,g.warningColor,c),(0,i.Z)(t,"countCount",!0),t))},"".concat(r||"No options available."))),s&&he(x.Z,{className:g.disabledColor,size:30})),a&&he(te.Z,{variant:"overline",display:"block",gutterBottom:!0,style:{fontWeight:300,lineHeight:1.66}},a),he(ve.X,{isVertical:u,version:d,filterMap:p,setFilterMap:f})))}var xe=n(18495),Ze=n(21085),we=n(14461),Ce=n(25593),je=n(52059),Oe=n(8717),Pe=n(26765),Se=n(53673),Ee=n(39210),Ie=n(82669),Ne=n(85697),Te=n(28999),Fe=n(28761),De=n(41422),Re=u.createElement;function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ae(e){var t=e.width,n=e.height,r=(e.margin,e.key,e.value,e.data,[{name:"GHGI"},{name:"GHGI Gas"},{name:"GHGI Electricity"}]),o=[{source:"GHGI Gas",target:"GHGI",value:"1.4"},{source:"GHGI Electricity",target:"GHGI",value:"5.2"}],i=(0,xe.Z)().nodeId((function(e){return e.name})),a=[Ze.Z,we.Z,Ce.Z,je.Z,Oe.Z,Pe.Z,Se.Z,Ee.Z,Ie.Z,Ne.Z];var c=u.useState(""),l=(0,s.Z)(c,2),d=l[0],p=l[1],f=u.useMemo((function(){return i.extent([[10,10],[t-10,n-10]])({nodes:r,links:o.map((function(e){return qe(qe({},e),{},{value:Number(e.value)})}))})}),[n,t]),g=u.useMemo((function(){return Math.max.apply(Math,(0,re.Z)(f.nodes.map((function(e){return e.depth}))))}),[f]),m=u.useCallback((function(e){var t=i.nodeId()(e);p(d===t?"":t)}),[d]),v=u.useMemo((function(){return""===d?new Set:new Set(f.links.filter((function(e){return i.nodeId()(e.source)===d||i.nodeId()(e.target)===d})))}),[d,f]);return Re("svg",{height:n,width:t},a.map((function(e){return Re(e,{id:e.name})})),Re("g",null,f.nodes.map((function(e){return Re(De.Z,{dx:e.depth===g?e.x0-2:e.x1+2,dy:e.y0+(e.y1-e.y0)/2,verticalAnchor:"middle",textAnchor:e.depth===g?"end":"start",tw:"font-mono text-sm"},e.name)}))),Re("g",null,f.links.map((function(e){return Re(Te.Z,{data:e,source:function(e){return{x:e.source.x1,y:e.y0}},target:function(e){return{x:e.target.x0,y:e.y1}},x:function(e){return e.x},y:function(e){return e.y},fill:"none",stroke:v.has(e)?"firebrick":"grey",strokeWidth:e.width,tw:"opacity-20 hover:opacity-60"})}))),Re("g",null,f.nodes.map((function(e){var t;i.nodeId()(e);return Re(Fe.Z,{x:e.x0,height:e.y1-e.y0,width:e.x1-e.x0,y:e.y0,onClick:function(){return m(e)},radius:2.5,fill:"url(#".concat(a[(t=e.index,t%a.length)].name,")"),all:!0})}))))}var Me=n(5152),We=u.createElement,_e=(0,Me.default)((function(){return Promise.all([n.e(960),n.e(234)]).then(n.bind(n,49234))}),{ssr:!1,loadableGenerated:{webpack:function(){return[49234]},modules:["../components/Charts/DataCharts.jsx -> ./PieChart"]}}),Ue=(0,Me.default)((function(){return Promise.all([n.e(960),n.e(550)]).then(n.bind(n,48550))}),{ssr:!1,loadableGenerated:{webpack:function(){return[48550]},modules:["../components/Charts/DataCharts.jsx -> ./RadarChart"]}}),Ve=(0,Me.default)((function(){return Promise.all([n.e(960),n.e(314)]).then(n.bind(n,7314))}),{ssr:!1,loadableGenerated:{webpack:function(){return[7314]},modules:["../components/Charts/DataCharts.jsx -> ./AxisChart"]}}),He=function(e){return{radar:We(Ue,{width:e.width,height:e.width,data:e.data}),pie:We(_e,{width:e.width,height:e.width,title:e.title,data:e.data}),sankey:We(Ae,{width:e.width,height:e.width,title:e.title,item:e.data}),axis:We(Ve,{width:e.width,height:e.width,title:e.title,item:e.data})}[e.type]};function Le(e){var t=e.item,n=e.version,r=e.charts,o=(e.image,r.map((function(e){var r=e.config,o=n.fieldInfo.filter((function(e){return r.includes(e.fieldUniqueName)})).reduce((function(e,t){return e[t.fieldUniqueName]=t,e}),{}),i=(Object.keys(o).every((function(e){return t[e]})),Object.keys(o).map((function(e){var n=void 0;if("text"===o[e].fieldType){var r=JSON.parse("["+t[e].replace(/ /g,"").split("|").join(",")+"]");if(!r||r.length<2)return;n=r[0].map((function(e,t){return{x:e,y:r[1][t]}}))}var i,a,s,c=e.replace("in:","").replace("out:",""),l=c.match(/\b(\w)/g).join("");return{key:c,acr:l,fieldType:o[e].fieldType,values:n,value:t[e],min:o[e].min,max:o[e].max,normalized:(i=t[e],a=o[e].min,s=o[e].max,s-a===0?1:(i-a)/(s-a))}}))),a=i.length>0&&i.every((function(e){return e}));return{config:o,type:e.type,data:i,hasAllData:a}})));return We(f.Z,{container:!0,justify:"flex-start",alignItems:"flex-start",direction:"row",spacing:3},o.filter((function(e){return e.hasAllData})).map((function(e,t){return We(f.Z,{xs:6,item:!0},We(d.Z,null,(function(t){return We(He,{type:e.type,width:t.width,height:t.width,config:e.config,data:e.data,name:e.name})})))})))}var ze=u.createElement,Ge=(0,pe.Z)((function(e){return{root:{padding:e.spacing(2),overflow:"visible"}}}))(fe.Z),Ye=(0,g.Z)((function(e){!function(e){e.palette.background.paper}(e);return{contentRoot:{textAlign:"center"}}}));function Qe(e){var t=e.open,n=e.selected,r=e.version,o=e.onCancelled,i=Ye();return ze(me.kH,{onClose:o,"aria-label":"charts-dialog",open:t},ze(z.$N,{id:"customized-dialog-title"},"Charts"),ze(Ge,{className:i.contentRoot},n&&ze(Le,{item:n,version:r,charts:[{type:"radar",name:"Model Input",config:["in:Program 1 WWR","in:Program 2 WWR","in:ERV Efficiency","in:Window U-Value","in:Window SHGC","in:Roof R-Value","in:Wall R-Value"]},{type:"pie",name:"Total Energy Use Intensity (EUI)",config:["out:Lighting (kWh/m2)","out:Equipment (kWh/m2)","out:Fans (kWh/m2)","out:Pumps (kWh/m2)","out:DHW (kWh/m2)","out:Clg Energy (kWh/m2)","out:Htg Energy (kWh/m2)"]},{type:"pie",name:"Heating Cooling Split",config:["out:TEDI (kWh/m2)","out:CEDI (kWh/m2)"]},{type:"axis",name:"Heating Cooling Annual Load Profile",config:["out:Cooling Profile","out:Heating Profile"]}]})))}var Je=n(53758),Xe=n(2804),$e=n(48671),Ke=u.createElement,et=(0,pe.Z)((function(e){return{root:{padding:e.spacing(2),overflow:"visible"}}}))(fe.Z),tt=(0,g.Z)((function(e){var t=function(e){return e.palette.background.paper}(e);return{messageBox:{paddingLeft:e.spacing(3),paddingRight:e.spacing(3),marginTop:e.spacing(3),paddingTop:e.spacing(3),background:t,backgroundClip:"padding-box",paddingBottom:e.spacing(2),borderRadius:"10px 10px 0px 0px",color:e.palette.getContrastText(e.palette.background.paper)},countLabel:{verticalAlign:"middle",color:e.palette.getContrastText(e.palette.background.paper)},countBox:{position:"sticky",top:"64px",width:"100%",zIndex:101,background:t,backgroundClip:"padding-box",marginTop:e.spacing(3),marginBottom:e.spacing(3)},labelIcon:{verticalAlign:"middle"},warningColor:{color:e.palette.warning.main},disabledColor:{color:e.palette.action.disabled},contentRoot:{textAlign:"center"}}}));function nt(e){var t=e.open,n=e.onCancelled,r=e.title,o=void 0===r?"Append To Dataset":r,i=tt();return Ke(me.kH,{onClose:n,"aria-label":"pre-filter-dialog",open:t},Ke(z.$N,{id:"customized-dialog-title",onClose:n},o),Ke(et,{className:i.contentRoot},Ke($e.r,null)))}var rt=n(11163),ot=u.createElement,it=function(){return ot(f.Z,{item:!0,xs:12},ot($.Z,{variant:"rect",width:"100%",height:900,style:{marginBotton:10,borderRadius:9}}),ot($.Z,{width:"100%",height:70,style:{marginBotton:10,borderRadius:9}}))},at=function(){return ot(f.Z,{item:!0,xs:12,style:{marginBottom:12.5}},ot($.Z,{variant:"rect",width:"100%",height:110,style:{marginTop:0,marginBotton:12.5,borderRadius:9}}))};function st(e){return ot(de.Z,(0,l.Z)({elevation:6,variant:"filled"},e))}var ct=(0,g.Z)((function(e){return{containerRoot:function(t){return(0,c.Z)(t),{backgroundColor:e.palette.background.default,padding:e.spacing(4)}},stickyItem:{top:0,position:"sticky"},innerGridItem:{marginBottom:e.spacing(2)},charts:{width:650,padding:e.spacing(4)},fullCharts:{width:"auto"},card:{border:"none",boxShadow:"none",borderRadius:9},customButton:{marginRight:e.spacing(1),borderRadius:9,padding:e.spacing(1.5)},filterSet:{marginRight:e.spacing(1)},prefilterBadgeWarning:{backgroundColor:e.palette.warning.main},prefilterBadgeSuccess:{backgroundColor:e.palette.primary.main},overlayParentContainer:{position:"relative",width:"100%"},parcoordsContainer:{paddingTop:e.spacing(3),zIndex:10,gridArea:"1 / 1 / 2 / 2"},snack:{width:"100%","& > * + *":{marginTop:e.spacing(2)},"& .MuiAlert-icon":{padding:"10px 0"}},optionSpacer:{marginRight:e.spacing(1)}}})),lt=(0,Xe.cn)({key:"_datasetDisplayRoutingAtom",default:{datasetId:null,projectId:null}});var ut=function(e){var t,n=e.datasetId,r=e.projectId,c=e.limit,l=void 0===c?5e3:c,g=(0,Xe.Zl)(lt);(0,u.useEffect)((function(){g({datasetId:n,projectId:r})}),[n,r]);var j=(0,rt.useRouter)(),O=(0,R.GF)(),P=(0,s.Z)(O,3),S=P[0],I=(P[1],P[2]),N=(0,q.we)(l),T=(0,s.Z)(N,14),F=T[0],z=T[1],G=T[2],$=T[3],re=T[4],oe=T[5],ie=T[6],ae=T[7],se=(T[8],T[9],T[10]),de=(T[11],T[12]),pe=(T[13],(0,W.Xw)()),fe=(0,s.Z)(pe,3),ge=fe[0],me=fe[1],ve=(fe[2],(0,W.UV)()),he=(0,s.Z)(ve,2),be=he[0],ye=he[1],xe=(0,W.qn)(),Ze=(0,s.Z)(xe,2),we=Ze[0],Ce=Ze[1],je=(0,A.v)(),Oe=(0,s.Z)(je,2),Pe=Oe[0],Se=Oe[1],Ee=(0,A.Y)(),Ie=(0,s.Z)(Ee,2),Ne=(Ie[0],Ie[1]),Te=(0,M.x)(),Fe=(0,s.Z)(Te,2),De=Fe[0],Re=Fe[1],Be=(0,R.uW)(),qe=((0,R.Dg)(),(0,R.Vh)()),Ae=(0,s.Z)(qe,2),Me=Ae[0],We=(Ae[1],u.useState(!1)),_e=(0,s.Z)(We,2),Ue=_e[0],Ve=_e[1],He=(0,B.N9)(),Le=function(e,t){"clickaway"!==t&&Ve(!1)},ze=u.useState(!0),Ge=(0,s.Z)(ze,2),Ye=Ge[0],$e=(Ge[1],u.useState({drawerRight:!1})),Ke=(0,s.Z)($e,2),et=(Ke[0],Ke[1],u.useState("out:Elec Energy (kWh/m2)")),tt=(0,s.Z)(et,2),ut=tt[0],dt=(tt[1],function(e){Ne((function(t){return t&&e._id===t._id?null:e}))});function pt(){return(pt=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Se(t),bt(gt.charts);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ft(){return(ft=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:zt&&!zt.find((function(e){return e._id===t._id}))?Gt(t):Yt(t._id);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var gt={none:0,save:1,prefilter:2,deleteDataset:3,confirmFilterSelect:4,charts:5,deleteFilterset:6,upload:7},mt=(0,u.useState)(0),vt=mt[0],ht=mt[1],bt=function(e){return ht(vt===e?gt.none:e)},yt=(0,u.useState)(!1),kt=yt[0],xt=yt[1];(0,u.useEffect)((function(){!$&&!oe||kt||vt===gt.prefilter||(xt(!0),bt(gt.prefilter))}),[$,oe,vt,kt,n]),(0,u.useEffect)((function(){$||xt(!1)}),[n,$]);var Zt=ct(),wt=function(e){var t;return null===S||void 0===S||null===(t=S.fileReferences)||void 0===t?void 0:t.find((function(t){return t._id===e}))},Ct=(0,q.vx)(),jt=(0,s.Z)(Ct,4),Ot=jt[0],Pt=jt[1],St=jt[2],Et=jt[3];(0,u.useEffect)((function(){Ot&&(console.log("saved!"),bt(gt.none),Bt(!1),Wt(Ot))}),[Ot]);var It=(0,q.W3)(),Nt=(0,s.Z)(It,4),Tt=Nt[0],Ft=(Nt[1],Nt[2],Nt[3]);(0,u.useEffect)((function(){null!==Tt&&void 0!==Tt&&Tt._id&&(console.log("saved!"),bt(gt.none),j.push("/projects/".concat(r,"/datasets/").concat(Tt._id)))}),[Tt]);var Dt=(0,u.useState)(!1),Rt=Dt[0],Bt=Dt[1],qt=(0,q.ou)(),At=(0,s.Z)(qt,2),Mt=At[0],Wt=At[1],_t=(0,u.useState)(null),Ut=_t[0],Vt=_t[1],Ht=(0,ne.b)(null===Mt||void 0===Mt?void 0:Mt._id),Lt=(0,s.Z)(Ht,3),zt=Lt[0],Gt=Lt[1],Yt=Lt[2],Qt=(0,q.H9)(),Jt=(0,s.Z)(Qt,4),Xt=(Jt[0],Jt[1]),$t=(Jt[2],Jt[3]),Kt=Mt&&"new"!==Mt._id,en=u.useState(null),tn=(0,s.Z)(en,2),nn=tn[0],rn=tn[1],on=Boolean(nn),an=function(){rn(null)},sn=(0,R.hT)()===R.qW.predesign;return ot(m.Z,{fixed:!0,className:Zt.containerRoot},de&&ot(f.Z,{container:!0},ot(f.Z,{item:!0,xs:12},ot(te.Z,{variant:"h3",style:{marginBottom:0}},"Dataset removed"),ot(te.Z,{variant:"body1"},"Click ",ot(p.Z,{color:"inherit",href:"/projects/".concat(r),underline:"none"},"here")," to head back to the project page"))),!ie||I&&ot(f.Z,{container:!0},ot(f.Z,{item:!0,xs:12},ot(te.Z,{variant:"h3",style:{marginBottom:0}},"Dataset not found"),ot(te.Z,{variant:"body1"},"Click ",ot(p.Z,{color:"inherit",href:"/projects/".concat(r),underline:"none"},"here")," to head back to the project page"))),!de&&S&&ot(f.Z,{container:!0,alignItems:"flex-start",direction:"row",spacing:3},ot(f.Z,{item:!0,md:4,xs:12},ot(te.Z,{variant:"h3",style:{marginBottom:0,marginTop:0}},S.name),ot(te.Z,{variant:"body2"},S.descriptionShort)),ot(f.Z,{container:!0,md:8,item:!0,xs:12,direction:"row-reverse"},!Be&&ot(u.Fragment,null,ot(v.Z,{variant:"outlined",className:Zt.customButton,"aria-controls":"fade-menu","aria-haspopup":"true",onClick:function(e){return rn(e.currentTarget)}},ot(ue.Z,null)),ot(h.Z,{id:"fade-menu",anchorEl:nn,keepMounted:!0,open:on,onClose:an,TransitionComponent:b.Z},false,ot(y.Z,{onClick:function(){an(),bt(gt.deleteDataset)}},ot(K.Z,{style:{marginRight:12}}),"Delete dataset"),ot(y.Z,{onClick:function(){an()}},ot(ee.Z,{style:{marginRight:12}})," Share dataset"))),ot(k.ZP,{title:"Toggle bookmarked view",arrow:!0},ot(Je.j,{variant:"contained",color:De.showBookmarks?"default":"secondary",onClick:function(){Re((function(e){return{showBookmarks:!(null!==e&&void 0!==e&&e.showBookmarks)}}))},disableElevation:!0,"aria-label":"bookmarks-dataset",className:(0,U.Z)(Zt.customButton)},ot(E.Z,null),"\xa0",(null===zt||void 0===zt?void 0:zt.length)||0)),ot(k.ZP,{title:"Pre-filter to de-clutter",arrow:!0},ot(Je.j,(t={className:Zt.customButton,variant:"contained",color:vt===gt.prefilter?"secondary":$||oe?"altWarning":"default",disableElevation:!0,"aria-label":"pre-filter"},(0,i.Z)(t,"className",(0,U.Z)(Zt.customButton,Zt.badgeChild)),(0,i.Z)(t,"selected",vt===gt.prefilter),(0,i.Z)(t,"onClick",(function(){return bt(gt.prefilter)})),t),ot(sn?V.Z:H.Z,null),"\xa0",G,re&&ot(x.Z,{size:17.5}))),!Be&&!sn&&ot(ce,{options:S.savedFilterSets,selected:Mt,onChange:function(e){Rt?(console.log("outstanding changes, setting pending"),Vt(e),bt(gt.confirmFilterSelect)):(console.log("no changes, setting set"),Wt(e))},deleting:Xt}),!Be&&!sn&&ot(k.ZP,{title:"Delete FilterSet",arrow:!0},ot(Je.j,{variant:"contained",disabled:!Mt||Mt&&"new"===Mt._id,color:"default",onClick:function(e){an(),bt(gt.deleteFilterset)},disableElevation:!0,"aria-label":"save-filterset",className:(0,U.Z)(Zt.customButton)},ot(K.Z,null))),ot(k.ZP,{title:Be?"Save Configuration":"Save FilterSet",arrow:!0},ot(Je.j,{variant:"contained",color:vt===gt.save?"secondary":Rt?"altWarning":"default",onClick:function(e){an(),bt(gt.save)},disableElevation:!0,"aria-label":"save-filterset",className:(0,U.Z)(Zt.customButton)},ot(L.Z,null))),!Be&&false),!ae&&$&&kt&&vt===gt.none&&ot(f.Z,{container:!0,style:{textAlign:"center"}},ot(f.Z,{item:!0,xs:12},ot(te.Z,{variant:"h4",style:{marginTop:45}},"This dataset is currently a little too big to browse, let's start by locking in some prefilters until we can get below ",l," options."))),ot("div",{className:Zt.overlayParentContainer},ot("div",{className:Zt.parcoordsContainer},ot(f.Z,{container:!0,item:!0,xs:12,spacing:3},ot(f.Z,{item:!0,xs:12,lg:7},(ae||re)&&ot(it,null),!ae&&!$&&!re&&He&&He.response&&ot(Z.Z,{variant:"outlined",className:Zt.card},ot(w.Z,null,ot(d.Z,null,(function(e){if(e.width){var t=He.response.filter((function(e){return!e.hasPreFilterRangeViolations}));return console.log("filtered"),console.log(He),ot(C.Z,{isVertical:Ye,data:t,dimensions:He.dimensions,width:e.width})}}))))),ot(f.Z,{item:!0,xs:12,lg:5},ot(f.Z,{container:!0},(ae||re)&&ot(u.Fragment,null,ot(at,null),ot(at,null),ot(at,null),ot(at,null),ot(at,null),ot(at,null),ot(at,null),ot(at,null),ot(at,null),ot(at,null),ot(at,null),ot(at,null)),!ae&&!$&&!re&&ge&&ge.map((function(e,t){return ot(f.Z,{item:!0,xs:12,key:t,className:Zt.innerGridItem},ot(D,{metric:ut,value:e[ut],isBookmarked:null===zt||void 0===zt?void 0:zt.find((function(t){return t._id===e._id})),warningText:e.hasPreFilterRangeViolations&&"This bookmark is out of range based on current filters.",image:wt(e.img._id),onBookmarkClick:function(t){return function(e){return ft.apply(this,arguments)}(e)},onItemClick:function(t){return dt(e)},onMouseLeave:function(e){return dt(null)},onShowMoreClick:function(t){return function(e){return pt.apply(this,arguments)}(e)}}))})),!He&&!(ae||re)&&ge&&0===me&&ot(te.Z,{style:{padding:12}},"No rows were returned based on your current filter."),De&&!$&&0===(null===zt||void 0===zt?void 0:zt.length)&&ot(te.Z,{style:{padding:12}},"No rows are currently bookmarked."),!ae&&!$&&!re&&ge&&me>0&&ot(f.Z,{item:!0,xs:12},ot(_.Z,{component:"div",labelRowsPerPage:"Showing",count:me,page:be,onPageChange:function(e,t){ye(t),window.scrollTo(0,0)},rowsPerPage:we,onRowsPerPageChange:function(e){Ce(parseInt(e.target.value,10)),ye(0)}})))))),ot(Y,{open:vt===gt.save,onCancelled:function(){return bt(gt.none)},onConfirmed:function(e){Be?Ft(e):Et(e)},saving:Pt,error:null===St||void 0===St?void 0:St.message,existingFilterSet:Kt?Mt:null}),ot(Q,{open:vt===gt.confirmFilterSelect,onCancelled:function(){return bt(gt.none)},onConfirmed:function(){bt(gt.none),Bt(!1),Wt(Ut),Vt(null)},selectedFilterSetName:null===Mt||void 0===Mt?void 0:Mt.name}),ot(J,{open:vt===gt.deleteDataset,onCancelled:function(){return bt(gt.none)},onConfirmed:se}),ot(X,{open:vt===gt.deleteFilterset,onCancelled:function(){return bt(gt.none)},existingFilterSet:Mt,onConfirmed:function(){$t({filterSetId:null===Mt||void 0===Mt?void 0:Mt._id}),Wt(null),bt(gt.none)}}),ot(ke,{open:vt===gt.prefilter,isVertical:Ye,version:Me,filterMap:F,setFilterMap:function(e){Rt||Bt(!0),z(e)},countInProgress:re,limitExceeded:$,limit:l,count:G,onCancelled:function(){return bt(gt.none)}}),ot(Qe,{open:vt===gt.charts,selected:Pe,version:Me,onCancelled:function(){return bt(gt.none)}}),ot(nt,{open:vt===gt.upload,onCancelled:function(){return bt(gt.none)}}))),ot("div",{className:Zt.snack},ot(le.Z,{anchorOrigin:{vertical:"bottom",horizontal:"right"},open:Ue,autoHideDuration:4e3,onClose:Le},ot(st,{onClose:Le,severity:"success"},Ue&&Ue))))}},48671:function(e,t,n){"use strict";n.d(t,{r:function(){return E}});var r=n(91229),o=n(26265),i=n(64121),a=n(38347),s=n(67294),c=n(11163),l=n(41120),u=n(22318),d=n(41749),p=n(282),f=n(95477),g=n(55869),m=n(42283),v=n(69090),h=n(67661),b=n(91594),y=n(87257),k=n(39905),x=n(12236),Z=n(94179),w=(n(86010),n(44689)),C=s.createElement;function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P=(0,l.Z)((function(e){return{loader:{maxHeight:"50vh"},cardRoot:{backgroundColor:e.palette.background.paper,paddingLeft:e.spacing(4),paddingRight:e.spacing(0),paddingBottom:e.spacing(3)},dialogActions:{padding:e.spacing(3)},paperRoot:{padding:e.spacing(3)},root:{marginTop:40},flexContainer:{display:"flex",alignItems:"flex-start",minHeight:"100vh"},stickyContainer:{top:0,right:0,position:"absolute"},stickyItem:{top:0,position:"sticky"},contentBody:{width:"50%"},gridRoot:{flexGrow:1},rootIcon:{color:"#eaeaf0",display:"flex",height:22,alignItems:"center"},active:{color:"#784af4"},circle:{width:25,height:25,borderRadius:"50%",backgroundColor:"currentColor",marginRight:e.spacing(1),textAlign:"center"},circleText:{color:"#eaeaf0"},completed:{backgroundColor:"#784af4",zIndex:1,fontSize:18}}}));function S(e,t){var n={};return t||(n.name={name:"Dataset Name",value:e.projectName,description:"The human readable moniker for this dataset.",editOnly:!0,paragraph:!0,required:!0},n.descriptionShort={name:"One Line Description",value:e.projectDescriptionShort,editOnly:!0,required:!1,paragraph:!0}),n.dataset={name:"Dataset",file:{multiple:!0,userPrompt:"Drag and drop your dataset files here (or click to use the system file browser)."},value:e.files,descrption:"Please select the dataset files (xlsx & images) that will be used with this dataset."},n}function E(e){var t=e.typeId,n=void 0===t?w.qW.earlyStage:t,o=(0,a.Z)(e,["typeId"]),l=(0,c.useRouter)().query.projectId,j=P(),E=(0,g.g)(),I=(0,i.Z)(E,10),N=I[0],T=(I[1],I[2]),F=I[3],D=I[4],R=I[5],B=I[6],q=I[7],A=I[8],M=I[9],W=(0,m.cI)(),_=W.handleSubmit,U=W.register,V=W.control,H=W.errors,L=W.unregister,z=W.watch,G=W.setValue,Y=(0,s.useState)(0),Q=Y[0],J=Y[1],X=(0,s.useState)(),$=X[0],K=X[1],ee=(0,w.GF)(),te=(0,i.Z)(ee,1)[0],ne=function(){J(0)};(0,s.useEffect)((function(){D&&J((function(e){return e+1}))}),[D]),(0,s.useEffect)((function(){A&&J((function(e){return e+1}))}),[A]);var re=[{label:te?"Additional Data":"Definition"},{label:"Analysis and Upload"},{label:"View Results"}];function oe(e){var t,r;switch(e){case 0:return C("div",null,!te&&C(u.Z,{variant:"body1"},"Tell us a bit about this dataset and select your files."),C(d.Z,{item:!0,xs:12},C(v.Z,{editing:!0,register:U,control:V,errors:H,unregister:L,setValue:G,watch:z,fields:S(N,te)})),C(d.Z,{container:!0,direction:"column"},R&&C(d.Z,{item:!0},C(Z.Z,{variant:"overline"},R+"")),C(d.Z,{item:!0},C(u.Z,{variant:"body1",style:{marginBottom:17.5}},"Let's run some analysis on the dataset and get it ready for upload"),C(p.Z,{onClick:_((function(e){return function(e){K(e),T(e)}(e)})),color:"secondary",variant:"contained",disableElevation:!0,size:"large",className:j.submitButton},F?C(f.Z,{size:20}):"Analyze"))));case 1:return C("div",null,C(u.Z,{variant:"body1"},"Please verify the fields and input data types that will be uploaded."),R&&C(d.Z,{item:!0},R+""),F&&C(f.Z,{size:20}),D&&C(d.Z,{item:!0,xs:12},D.fields&&C(v.Z,{editing:!0,register:U,control:V,errors:H,unregister:L,setValue:G,watch:z,fields:D.fields.map((function(e){return{key:g.S+e.name,name:e.name,required:!0,validate:e.existingType?function(t){return t===e.existingType||"This field has to be ".concat(e.existingType," type to match the existing dataset.")}:void 0,paragraph:!0,value:e.type,select:[{key:"Number",value:"number"},{key:"Text",value:"text"},{key:"File Reference",value:"fileReference"}]}}))}),C(d.Z,{container:!0,justify:"flex-start",alignItems:"flex-start",direction:"column"},M&&C(d.Z,{item:!0},M+""),C(d.Z,{item:!0},C(u.Z,{variant:"body1",style:{marginBottom:17.5}},"You're all set to for upload."),C(p.Z,{onClick:_((function(e){return function(e,t){var r=O(O(O({},$),e),{},{typeId:n});t&&(r.projectId=t),B(r)}(e,l)})),color:"secondary",variant:"contained",disableElevation:!0,size:"large",className:j.submitButton},q?C(f.Z,{size:20}):"Upload!"),C(p.Z,{color:"secondary",size:"large",onClick:ne,style:{marginLeft:10}},"I need to start over")))));case 2:return C("div",null,M&&C(u.Z,{variant:"body1",style:{marginTop:10}},"An error occured during the upload process.   Please contact your system administrator."),A&&A.response&&C(s.Fragment,null,C(u.Z,{variant:"body1",style:{marginTop:10}},C("strong",null,null===A||void 0===A||null===(t=A.response)||void 0===t||null===(r=t.rows)||void 0===r?void 0:r.length)," "," total rows were uploaded."),C(u.Z,{variant:"body1",style:{marginTop:10}},"Click "," ",C(x.Z,{color:"inherit",href:"/projects/".concat(l,"/datasets/").concat(A.response.definition._id),underline:"none"},"here")," "," to view your dataset.")));default:return"Unknown step"}}return C(h.Z,(0,r.Z)({activeStep:Q,orientation:"vertical"},o),re.map((function(e,t){var n=e.label;return C(b.Z,{key:n},C(y.Z,null,n),C(k.Z,null,oe(t)))})))}},99988:function(e,t,n){"use strict";n.d(t,{$N:function(){return k},mQ:function(){return O}});var r=n(64121),o=n(91229),i=n(38347),a=n(67294),s=n(14670),c=n(41120),l=n(66083),u=n(29525),d=n(66856),p=n(22318),f=n(39803),g=n(95477),m=n(94179),v=n(86010),h=n(2208),b=n(53758),y=a.createElement,k=(0,s.Z)((function(e){return{root:{margin:0,padding:e.spacing(2),paddingBottom:0},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]},messageBox:{textAlign:"center",paddingLeft:e.spacing(3),paddingRight:e.spacing(3),marginTop:e.spacing(3),paddingTop:e.spacing(3),background:C(e),backgroundClip:"padding-box",paddingBottom:e.spacing(2),borderRadius:"10px 10px 0px 0px",color:e.palette.getContrastText(e.palette.background.paper)}}}))((function(e){var t=e.children,n=e.classes,r=(0,i.Z)(e,["children","classes"]);return y(l.Z,(0,o.Z)({disableTypography:!0,className:n.root},r),y(m.Z,{variant:"h3",display:"block",gutterBottom:!0,className:n.messageBox},t))})),x=(0,s.Z)((function(e){return{root:{padding:"16px, 24px"}}}))(u.Z),Z=(0,s.Z)((function(e){return{root:{marginTop:e.spacing(2),padding:"16px, 24px",paddingRight:0,marginBottom:e.spacing(0)}}}))(d.Z);function w(e){var t=e.children,n=e.color,r=e.className,a=(0,i.Z)(e,["children","color","className"]);return y(b.j,(0,o.Z)({variant:"contained",autoFocus:!0,disableElevation:!0,color:n,className:(0,v.Z)(r,"dialog-button")},a),t)}var C=function(e){return e.palette.background.paper},j=(0,c.Z)((function(e){return{messageBox:{paddingLeft:e.spacing(3),paddingRight:e.spacing(3),marginTop:e.spacing(3),paddingTop:e.spacing(3),background:C(e),backgroundClip:"padding-box",paddingBottom:e.spacing(2),borderRadius:"10px 10px 0px 0px",color:e.palette.getContrastText(e.palette.background.paper)},button:{padding:e.spacing(1.5),borderRadius:9}}}));function O(e){var t=e.containerId,n=e.onConfirmed,o=e.onCancelled,i=e.onXButton,s=e.open,c=e.message,l=e.title,u=e.confirmText,d=e.confirmColor,v=e.cancelText,b=e.cancelColor,k=e.error,C=e.inProgress,O=e.requireTextEntry,P=e.textFieldLabel,S=e.textFieldValue,E=e.textFieldInputProps,I=e.includeSpacer,N=j(),T=a.useState(null),F=(0,r.Z)(T,2),D=F[0],R=F[1],B=a.useState(S||""),q=(0,r.Z)(B,2),A=q[0],M=q[1],W=a.useState(!O),_=(0,r.Z)(W,2),U=_[0],V=_[1],H=a.useState(""),L=(0,r.Z)(H,2),z=L[0],G=L[1];return(0,a.useEffect)((function(){M(S)}),[S]),(0,a.useEffect)((function(){V(!O)}),[O]),y(h.kH,{onClose:function(){i?i():o&&o()},containerId:t,"aria-label":l,open:s,title:l,includeSpacer:I},y(x,null,y(p.Z,{variant:"body2",display:"block",gutterBottom:!0,style:{fontWeight:300,lineHeight:1.66,marginBottom:20}},c),(O||S)&&y(f.Z,{variant:"outlined",required:!0,fullWidth:!0,error:D,helperText:D,id:"manual-settings-text-field",label:P||"Enter to continue",value:A,onChange:function(e){e.preventDefault(),O&&!e.target.value?(M(e.target.value),R("Required Field"),V(!1),G("")):O&&O.match&&O.match!==e.target.value?(M(e.target.value),R(e.target.name+" must match "+O.match),V(!1),G("")):(M(e.target.value),R(null),V(!0),G(e.target.value))},disabled:!!S,inputProps:E}),k&&y(m.Z,{variant:"body2",display:"block",gutterBottom:!0,style:{fontWeight:300,lineHeight:1.66}},k),C&&y(Z,null,y(g.Z,{size:48})),!C&&y(Z,null,y(w,{className:N.button,disabled:!U,onClick:function(){n(z)},color:d},u||"Confirm"),y(w,{className:N.button,onClick:function(){o?o():i&&i()},color:b},v||"Cancel"))))}},2208:function(e,t,n){"use strict";n.d(t,{kH:function(){return v}});var r=n(91229),o=n(38347),i=n(67294),a=n(41120),s=n(8920),c=n(52663),l=n(66083),u=n(17812),d=n(68130),p=n(29681),f=i.createElement,g=(0,a.Z)((function(e){return{root:{height:"max-content",minHeight:"100%",borderRadius:e.shape.borderRadius},closeButton:{padding:e.spacing(1),position:"absolute",top:0,right:0},backdrop:{position:"absolute",backdropFilter:"blur(5px)",borderRadius:e.shape.borderRadius,backgroundColor:p.Tt},paperScrollPaper:{overflow:"visible"}}}));function m(){return f("div",{style:{height:"46px",width:"100%"}})}function v(e){var t=e.children,n=e.label,i=e.onClose,a=e.open,p=e.includeSpacer,v=(0,o.Z)(e,["children","label","onClose","open","includeSpacer"]),h=g(),b=(0,s.Z)();return f(c.Z,(0,r.Z)({"aria-labelledby":"subwindow-dialog-".concat(n),disableAutoFocus:!0,disableEnforceFocus:!0,disableScrollLock:!0,disablePortal:!0,className:h.root,classes:{paperScrollPaper:h.paperScrollPaper},BackdropProps:{classes:{root:h.backdrop}},style:{position:"absolute",zIndex:b.zIndex.speedDial},onClose:i,open:a},v),f(l.Z,{className:h.closeButton,disableTypography:!0},f(u.Z,{"aria-label":"close",size:"small",onClick:i},f(d.Z,null))),p&&f(m,null),t)}},15894:function(e,t,n){"use strict";n.d(t,{JM:function(){return f},v3:function(){return m},WB:function(){return h},FR:function(){return y},pH:function(){return x},pY:function(){return Z},g8:function(){return C},Xd:function(){return O},RH:function(){return S},$l:function(){return I},wy:function(){return T}});var r=n(809),o=n.n(r),i=n(26265),a=n(64121),s=n(92447),c=n(39742);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t){return g.apply(this,arguments)}function g(){return(g=(0,s.Z)(o().mark((function e(t,n){var r,i,a,s,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,c.Z)("post",null,n,t);case 2:return r=e.sent,e.next=5,fetch("".concat(c.K,"/datasets/query/upload"),r);case 5:if(i=e.sent,a=null,i.ok){e.next=19;break}return e.prev=8,e.next=11,i.json();case 11:a=e.sent,e.next=16;break;case 14:e.prev=14,e.t0=e.catch(8);case 16:throw Error("Server Side error. ".concat(null!==(s=a)&&void 0!==s&&s.err?a.err:""," ").concat(null!==(l=a)&&void 0!==l&&l.msg?a.msg:""," Check network results in dev tools for full results. ").concat(i.status,"  ").concat(i.statusText));case 19:return e.prev=19,e.next=22,i.json();case 22:a=e.sent,e.next=29;break;case 25:throw e.prev=25,e.t1=e.catch(19),console.log(e.t1),Error("Error parsing json response.");case 29:return e.abrupt("return",a);case 30:case"end":return e.stop()}}),e,null,[[8,14],[19,25]])})))).apply(this,arguments)}function m(e,t){return v.apply(this,arguments)}function v(){return(v=(0,s.Z)(o().mark((function e(t,n){var r,i,a,s,l,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,c.Z)("post","application/json",{projectId:t},n);case 2:return i=e.sent,e.next=5,fetch("".concat(c.K,"/datasets/query/getDefinitions"),i);case 5:if(a=e.sent,s=null,a.ok){e.next=19;break}return e.prev=8,e.next=11,a.json();case 11:s=e.sent,e.next=16;break;case 14:e.prev=14,e.t0=e.catch(8);case 16:throw Error("Server Side error. ".concat(null!==(l=s)&&void 0!==l&&l.err?s.err:""," ").concat(null!==(u=s)&&void 0!==u&&u.msg?s.msg:""," Check network results in dev tools for full results. ").concat(a.status,"  ").concat(a.statusText));case 19:return e.prev=19,e.next=22,a.json();case 22:s=e.sent,e.next=29;break;case 25:throw e.prev=25,e.t1=e.catch(19),console.log(e.t1),Error("Error parsing json response.");case 29:return e.abrupt("return",null===(r=s)||void 0===r?void 0:r.definitions);case 30:case"end":return e.stop()}}),e,null,[[8,14],[19,25]])})))).apply(this,arguments)}function h(e,t){return b.apply(this,arguments)}function b(){return(b=(0,s.Z)(o().mark((function e(t,n){var r,i,a,s,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,c.Z)("post","application/json",{datasetId:t},n);case 2:return r=e.sent,e.next=5,fetch("".concat(c.K,"/datasets/query/getDefinition"),r);case 5:if(i=e.sent,a=null,i.ok){e.next=19;break}return e.prev=8,e.next=11,i.json();case 11:a=e.sent,e.next=16;break;case 14:e.prev=14,e.t0=e.catch(8);case 16:throw Error("Server Side error. ".concat(null!==(s=a)&&void 0!==s&&s.err?a.err:""," ").concat(null!==(l=a)&&void 0!==l&&l.msg?a.msg:""," Check network results in dev tools for full results. ").concat(i.status,"  ").concat(i.statusText));case 19:return e.prev=19,e.next=22,i.json();case 22:a=e.sent,e.next=29;break;case 25:throw e.prev=25,e.t1=e.catch(19),console.log(e.t1),Error("Error parsing json response.");case 29:return e.abrupt("return",a);case 30:case"end":return e.stop()}}),e,null,[[8,14],[19,25]])})))).apply(this,arguments)}function y(e){return k.apply(this,arguments)}function k(){return(k=(0,s.Z)(o().mark((function e(t){var n,r,i,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,c.Z)("post","application/json",null,t);case 2:return n=e.sent,e.next=5,fetch("".concat(c.K,"/datasets/query/getPredesignDefinition"),n);case 5:if(r=e.sent,i=null,r.ok){e.next=19;break}return e.prev=8,e.next=11,r.json();case 11:i=e.sent,e.next=16;break;case 14:e.prev=14,e.t0=e.catch(8);case 16:throw Error("Server Side error. ".concat(null!==(a=i)&&void 0!==a&&a.err?i.err:""," ").concat(null!==(s=i)&&void 0!==s&&s.msg?i.msg:""," Check network results in dev tools for full results. ").concat(r.status,"  ").concat(r.statusText));case 19:return e.prev=19,e.next=22,r.json();case 22:i=e.sent,e.next=29;break;case 25:throw e.prev=25,e.t1=e.catch(19),console.log(e.t1),Error("Error parsing json response.");case 29:return e.abrupt("return",i);case 30:case"end":return e.stop()}}),e,null,[[8,14],[19,25]])})))).apply(this,arguments)}function x(e){if(!e)throw Error("Must supply filter map to filter map serializer.");var t,n={},r=d(e);try{for(r.s();!(t=r.n()).done;){var o=(0,a.Z)(t.value,2),i=o[0],s=o[1];n[i]=u({fieldUniqueName:i},s)}}catch(c){r.e(c)}finally{r.f()}return n}function Z(e,t,n,r){return w.apply(this,arguments)}function w(){return(w=(0,s.Z)(o().mark((function e(t,n,r,i){var a,s,l,u,d,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n?x(n):null,e.next=3,(0,c.Z)("post","application/json",{datasetId:t,versionId:null===r||void 0===r?void 0:r._id,filter:a},i);case 3:return s=e.sent,e.next=6,fetch("".concat(c.K,"/datasets/query/getDataset"),s);case 6:if(l=e.sent,u=null,l.ok){e.next=20;break}return e.prev=9,e.next=12,l.json();case 12:u=e.sent,e.next=17;break;case 15:e.prev=15,e.t0=e.catch(9);case 17:throw Error("Server Side error. ".concat(null!==(d=u)&&void 0!==d&&d.err?u.err:""," ").concat(null!==(p=u)&&void 0!==p&&p.msg?u.msg:""," Check network results in dev tools for full results. ").concat(l.status,"  ").concat(l.statusText));case 20:return e.prev=20,e.next=23,l.json();case 23:u=e.sent,e.next=30;break;case 26:throw e.prev=26,e.t1=e.catch(20),console.log(e.t1),Error("Error parsing json response.");case 30:return e.abrupt("return",u);case 31:case"end":return e.stop()}}),e,null,[[9,15],[20,26]])})))).apply(this,arguments)}function C(e,t,n,r){return j.apply(this,arguments)}function j(){return(j=(0,s.Z)(o().mark((function e(t,n,r,i){var a,s,l,u,d,p,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n?x(n):null,e.next=3,(0,c.Z)("post","application/json",{datasetId:t,versionId:null===r||void 0===r?void 0:r._id,filter:s},i);case 3:return l=e.sent,e.next=6,fetch("".concat(c.K,"/datasets/query/getDatasetCount"),l);case 6:if(u=e.sent,d=null,u.ok){e.next=20;break}return e.prev=9,e.next=12,u.json();case 12:d=e.sent,e.next=17;break;case 15:e.prev=15,e.t0=e.catch(9);case 17:throw Error("Server Side error. ".concat(null!==(p=d)&&void 0!==p&&p.err?d.err:""," ").concat(null!==(f=d)&&void 0!==f&&f.msg?d.msg:""," Check network results in dev tools for full results. ").concat(u.status,"  ").concat(u.statusText));case 20:return e.prev=20,e.next=23,u.json();case 23:d=e.sent,e.next=30;break;case 26:throw e.prev=26,e.t1=e.catch(20),console.log(e.t1),Error("Error parsing json response.");case 30:return console.log("fetched count: ".concat(null===(a=d)||void 0===a?void 0:a.count)),e.abrupt("return",d);case 32:case"end":return e.stop()}}),e,null,[[9,15],[20,26]])})))).apply(this,arguments)}function O(e,t,n){return P.apply(this,arguments)}function P(){return(P=(0,s.Z)(o().mark((function e(t,n,r){var i,a,s,l,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,c.Z)("post","application/json",{datasetId:t,filterSet:n},r);case 3:return i=e.sent,e.next=6,fetch("".concat(c.K,"/datasets/query/saveFilterSet"),i);case 6:if(a=e.sent,s=null,a.ok){e.next=20;break}return e.prev=9,e.next=12,a.json();case 12:s=e.sent,e.next=17;break;case 15:e.prev=15,e.t0=e.catch(9);case 17:throw Error("Server Side error. ".concat(null!==(l=s)&&void 0!==l&&l.err?s.err:""," ").concat(null!==(u=s)&&void 0!==u&&u.msg?s.msg:""," Check network results in dev tools for full results. ").concat(a.status,"  ").concat(a.statusText));case 20:return e.prev=20,e.next=23,a.json();case 23:s=e.sent,e.next=30;break;case 26:throw e.prev=26,e.t1=e.catch(20),console.log(e.t1),Error("Error parsing json response.");case 30:return e.abrupt("return",s);case 33:throw e.prev=33,e.t2=e.catch(0),console.log(e.t2),e.t2;case 37:case"end":return e.stop()}}),e,null,[[0,33],[9,15],[20,26]])})))).apply(this,arguments)}function S(e,t,n,r,o,i,a){return E.apply(this,arguments)}function E(){return(E=(0,s.Z)(o().mark((function e(t,n,r,i,a,s,l){var u,d,p,f,g;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("Saving predesign at api"),e.next=4,(0,c.Z)("post","application/json",{predesignDatasetId:t,filterSet:i,existingProjectId:n,datasetName:r,datasetDescription:a,newProject:s},l);case 4:return u=e.sent,e.next=7,fetch("".concat(c.K,"/datasets/query/saveNewPredesign"),u);case 7:if(d=e.sent,p=null,d.ok){e.next=21;break}return e.prev=10,e.next=13,d.json();case 13:p=e.sent,e.next=18;break;case 16:e.prev=16,e.t0=e.catch(10);case 18:throw Error("Server Side error. ".concat(null!==(f=p)&&void 0!==f&&f.err?p.err:""," ").concat(null!==(g=p)&&void 0!==g&&g.msg?p.msg:""," Check network results in dev tools for full results. ").concat(d.status,"  ").concat(d.statusText));case 21:return e.prev=21,e.next=24,d.json();case 24:p=e.sent,e.next=31;break;case 27:throw e.prev=27,e.t1=e.catch(21),console.log(e.t1),Error("Error parsing json response.");case 31:return e.abrupt("return",p);case 34:throw e.prev=34,e.t2=e.catch(0),console.log(e.t2),e.t2;case 38:case"end":return e.stop()}}),e,null,[[0,34],[10,16],[21,27]])})))).apply(this,arguments)}function I(e,t,n){return N.apply(this,arguments)}function N(){return(N=(0,s.Z)(o().mark((function e(t,n,r){var i,a,s,l,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,c.Z)("delete","application/json",{datasetId:t,filterSetId:n},r);case 2:return i=e.sent,e.next=5,fetch("".concat(c.K,"/datasets/query/deleteFilterSet"),i);case 5:if(a=e.sent,s=null,a.ok){e.next=19;break}return e.prev=8,e.next=11,a.json();case 11:s=e.sent,e.next=16;break;case 14:e.prev=14,e.t0=e.catch(8);case 16:throw Error("Server Side error. ".concat(null!==(l=s)&&void 0!==l&&l.err?s.err:""," ").concat(null!==(u=s)&&void 0!==u&&u.msg?s.msg:""," Check network results in dev tools for full results. ").concat(a.status,"  ").concat(a.statusText));case 19:return e.prev=19,e.next=22,a.json();case 22:s=e.sent,e.next=29;break;case 25:throw e.prev=25,e.t1=e.catch(19),console.log(e.t1),Error("Error parsing json response.");case 29:return e.abrupt("return",s);case 30:case"end":return e.stop()}}),e,null,[[8,14],[19,25]])})))).apply(this,arguments)}function T(e,t){return F.apply(this,arguments)}function F(){return(F=(0,s.Z)(o().mark((function e(t,n){var r,i,a,s,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,c.Z)("delete","application/json",{datasetId:t},n);case 2:return r=e.sent,e.next=5,fetch("".concat(c.K,"/datasets/query/deleteDataset"),r);case 5:if(i=e.sent,a=null,i.ok){e.next=19;break}return e.prev=8,e.next=11,i.json();case 11:a=e.sent,e.next=16;break;case 14:e.prev=14,e.t0=e.catch(8);case 16:throw Error("Server Side error. ".concat(null!==(s=a)&&void 0!==s&&s.err?a.err:""," ").concat(null!==(l=a)&&void 0!==l&&l.msg?a.msg:""," Check network results in dev tools for full results. ").concat(i.status,"  ").concat(i.statusText));case 19:return e.prev=19,e.next=22,i.json();case 22:a=e.sent,e.next=29;break;case 25:throw e.prev=25,e.t1=e.catch(19),console.log(e.t1),Error("Error parsing json response.");case 29:return e.abrupt("return",a);case 30:case"end":return e.stop()}}),e,null,[[8,14],[19,25]])})))).apply(this,arguments)}},97352:function(e,t,n){"use strict";n.d(t,{we:function(){return k},aj:function(){return w},ou:function(){return C},vx:function(){return j},W3:function(){return O},H9:function(){return P}});var r=n(91229),o=n(809),i=n.n(o),a=n(92447),s=n(64121),c=n(67294),l=n(88767),u=n(2804),d=n(58364),p=n(15894),f=n(30582),g=n(44689),m=n(84176),v=n(67095),h=n(13138),b=(0,u.cn)({key:"currentDatasetCountAtom",default:{count:null,inProgress:!1,error:null,filterUsed:null}});var y=(0,u.cn)({key:"preFilterAtom",default:new Map});function k(e){var t=(0,u.FV)(y),n=(0,s.Z)(t,2),o=n[0],l=n[1],m=w(),v=(0,g.GF)(),h=(0,s.Z)(v,1)[0],k=null===h||void 0===h?void 0:h._id;(0,c.useEffect)((function(){if(m)if(console.log("selectedFilterSet"),console.log(m),"new"!==(null===m||void 0===m?void 0:m._id)){var e=function(e){var t=new Map;return e.forEach((function(e){var n=(0,r.Z)({},e);"number"===n.type&&(n.value=[n.min,n.max]),t.set(n.fieldUniqueName,n)})),t}(m.preFilters);l(e)}else l(new Map)}),[m]);var x=(0,f.p)(o,!0),Z=(0,s.Z)(x,9),C=Z[0],j=Z[1],O=Z[2],P=Z[3],S=Z[4],E=Z[5],I=Z[6],N=Z[7],T=Z[8],F=function(e){var t=(0,u.FV)(b),n=(0,s.Z)(t,2),r=n[0],o=r.count,l=r.inProgress,f=r.error,m=n[1],v=(0,d.dQ)(),h=(0,s.Z)(v,3),y=h[0],k=(h[1],h[2],(0,g.e7)()),x=(0,s.Z)(k,1)[0];console.log(x);var Z=null===x||void 0===x?void 0:x._id,w=(0,g.Q9)(),C=Z,j=function(){var e=(0,a.Z)(i().mark((function e(t){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("fetching count for datasetId "+C),console.log(t),m({count:null,inProgress:!0,error:null,filterUsed:null}),e.next=6,(0,p.g8)(C,t,w,y);case 6:if((n=e.sent).count){e.next=9;break}throw Error("No count returned.");case 9:m({count:n.count,inProgress:!1,error:null,filterUsed:t}),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(0),console.log("fetching count error"),console.error(e.t0),m({error:e.t0,inProgress:!1});case 17:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}();return(0,c.useEffect)((function(){!y||!C||o||f||l||j(e)}),[y,o,C,e]),[o,l,f,function(){m({count:null,error:!1,inProgress:!1})}]}(o),D=(0,s.Z)(F,4),R=D[0],B=D[1],q=D[2],A=D[3],M=R>e,W=(0,g.Q9)();return(0,c.useEffect)((function(){l(new Map),T()}),[k]),(0,c.useEffect)((function(){A()}),[o,W]),(0,c.useEffect)((function(){R&&e&&!M&&(console.log("count acceptable, fetching dataset"),P())}),[R,e]),[o,l,R,M,B,q,C,j,O,P,S,E,I,N,T]}(0,u.cn)({key:"changesToSaveAtom",default:!1});var x=(0,u.cn)({key:"_selectedFilterSetAtom",default:null}),Z=(0,u.nZ)({key:"selectedFilterSetSelector",get:function(){var e=(0,a.Z)(i().mark((function e(t){var n,r,o,a,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.get,o=r(g.jp),a=r(g.aN),s=null===a||void 0===a||null===(n=a.savedFilterSets)||void 0===n?void 0:n[0],o!==g.qW.predesign){e.next=8;break}return e.abrupt("return",s);case 8:return e.abrupt("return",r(x));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),set:function(e,t){return(0,e.set)(x,t)}});function w(){return(0,h.o)(Z)}function C(){var e=(0,h.Lx)(Z),t=(0,s.Z)(e,2);return[t[0],t[1]]}function j(){var e,t=(0,l.useMutation)((function(e){var t=e.datasetId,n=e.filterSet,r=e.token;return(0,p.Xd)(t,n,r)})),n=(0,d.dQ)(),r=(0,s.Z)(n,3),o=r[0],i=(r[1],r[2],(0,u.sJ)(y)),a=null===(e=(0,g.GF)())||void 0===e?void 0:e.response,c=(0,u.sJ)(m.$);return[t.data,t.isLoading,t.isError?t.error:null,function(e){var n=e._id,r=e.name,s=e.description,l=e.image;if(!a||!a._id)throw Error("No datasetId provided");var u="new"===n?null:n;if(!r&&!u)throw Error("Must provide dataset name");if(!i)throw Error("No filters provided");if(!o)throw Error("Must provide token");var d=(0,p.pH)(i);console.log(d),console.log(c);var f={_id:u,name:r,description:s,image:l,preFilters:d,bookmarks:c};t.mutate({datasetId:a._id,filterSet:f,token:o})}]}function O(){var e=(0,l.useMutation)((function(e){var t=e.predesignDatasetId,n=e.existingProjectId,r=e.datasetName,o=e.filterSet,i=e.datasetDescription,a=e.newProject,s=e.token;return(0,p.RH)(t,n,r,o,i,a,s)})),t=(0,d.dQ)(),n=(0,s.Z)(t,3),r=n[0],o=(n[1],n[2],(0,u.sJ)(y)),i=(0,g.GF)(),a=(0,s.Z)(i,1)[0],c=null===a||void 0===a?void 0:a._id,f=(0,v.P)(),h=(0,s.Z)(f,1)[0],b=null===h||void 0===h?void 0:h._id,k=(0,u.sJ)(m.$);return[e.data,e.isLoading,e.isError?e.error:null,function(t){var n=t.name,i=t.description,a=t.newProject;if(!c)throw Error("No predesignDatasetId provided");if(!b)throw Error("No existingProjectId provided");if(!n)throw Error("Must provide dataset name");if(!o)throw Error("No filters provided");if(!r)throw Error("Must provide token");var s=(0,p.pH)(o);console.log("Saving predesign"),console.log(n),console.log(s);var l={name:n,preFilters:s,bookmarks:k};e.mutate({predesignDatasetId:c,existingProjectId:b,datasetName:n,filterSet:l,datasetDescription:i,newProject:a,token:r})}]}function P(){var e=(0,l.useMutation)((function(e){var t=e.datasetId,n=e.filterSetId,r=e.token;return(0,p.$l)(t,n,r)})),t=(0,d.dQ)(),n=(0,s.Z)(t,3),r=n[0],o=(n[1],n[2],(0,g.GF)().response);return[e.data,e.isLoading,e.isError?e.error:null,function(t){console.log(t);var n=t.filterSetId;if(!o||!o._id)throw Error("No datasetId provided");if(console.log(n),!n)throw Error("Must provide filterSetId");if(!r)throw Error("Must provide token");e.mutate({datasetId:o._id,filterSetId:n,token:r})}]}},30582:function(e,t,n){"use strict";n.d(t,{q:function(){return v},p:function(){return h}});var r=n(26265),o=n(809),i=n.n(o),a=n(92447),s=n(64121),c=n(67294),l=n(2804),u=n(58364);n(20764),(0,l.cn)({key:"dimensionFilterAtom",default:!1});var d=n(15894),p=n(44689);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m={response:!1,inProgress:!1,error:!1,serverFilter:new Map,lastFetchId:0,fetchId:0,deleting:!1,deletingResponse:!1,deletingError:!1},v=(0,l.cn)({key:"datasetAtom",default:m});function h(e){var t=(0,l.FV)(v),n=(0,s.Z)(t,2),r=n[0],o=n[1],f=(0,u.dQ)(),m=(0,s.Z)(f,3),h=m[0],b=(m[1],m[2],(0,p.Q9)()),y=(0,p.e7)(),k=(0,s.Z)(y,1)[0],x=null===k||void 0===k?void 0:k._id,Z=function(){var e=(0,a.Z)(i().mark((function e(t,n){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("fetching datasetId "+t),o({response:null,error:!1,inProgress:!0}),e.next=5,(0,d.pY)(t,n,b,h);case 5:r=e.sent,o({response:r,inProgress:!1,error:!1,serverFilter:n}),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("useDefinition error"),console.error(e.t0),o({error:e.t0,inProgress:!1});case 14:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,n){return e.apply(this,arguments)}}();(0,c.useEffect)((function(){0===r.fetchId||r.fetchId===r.lastFetchId||!h||!x||r.response||r.error||r.inProgress||Z(x,e)}),[h,r,x,e,r.fetchId]);var w=function(){var e=(0,a.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("deleting datasetId "+x),o({response:null,deleting:!0,deletingResponse:!1,deletingError:!1}),e.next=5,(0,d.wy)(x,h);case 5:e.sent,o({response:null,deleting:!1,deletingResponse:!0,deletingError:!1}),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("useDefinition error"),console.error(e.t0),o(g(g({},r),{},{deleting:!1,deletingResponse:!1,deletingError:e.t0}));case 14:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return[r,r.inProgress,r.error,function(){o({response:!1,error:!1,inProgress:!1,lastFetchId:r.fetchId,fetchId:r.fetchId+1})},w,r.deleting,r.deletingResponse,r.deletingError,function(){o({response:!1,error:!1,inProgress:!1,fetchId:r.fetchId})}]}},84176:function(e,t,n){"use strict";n.d(t,{$:function(){return d},b:function(){return p}});var r=n(809),o=n.n(r),i=n(59999),a=n(92447),s=n(64121),c=n(67294),l=n(2804),u=n(97352),d=(0,l.cn)({key:"datasetBookmarksAtom",default:[]});function p(e){var t=(0,l.FV)(d),n=(0,s.Z)(t,2),r=n[0],p=n[1],f=(0,u.aj)();function g(){return(g=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("add bookmark "+t._id);try{!r||null!==r&&void 0!==r&&r.find((function(e){return e._id===t._id}))||p([].concat((0,i.Z)(r),[t]))}catch(n){console.error("usedatasetbookmark error"),console.error(n)}case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(){return(m=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("remove bookmark "+t);try{p(r.filter((function(e){return e._id!==t})))}catch(n){console.error("usedatasetbookmark error"),console.error(n)}case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,c.useEffect)((function(){p(f&&f.bookmarks&&f.bookmarks||[])}),[f]),[r,function(e){return g.apply(this,arguments)},function(e){return m.apply(this,arguments)}]}},44689:function(e,t,n){"use strict";n.d(t,{uW:function(){return p},aN:function(){return f},GF:function(){return g},qW:function(){return m},jp:function(){return v},hT:function(){return h},GC:function(){return b},e7:function(){return k},Dg:function(){return Z},or:function(){return C},Q9:function(){return j},Vh:function(){return O},Rs:function(){return S}});var r=n(809),o=n.n(r),i=n(92447),a=(n(67294),n(2804)),s=n(58364),c=n(85835),l=n(15894),u=n(13138),d=(0,a.nZ)({key:"newPredesignSelector",get:function(){var e=(0,i.Z)(o().mark((function e(t){var n,r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.get,r=n(c.k),r.projectId,i=r.datasetId,r.predesign,e.abrupt("return","predesign"===i);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()});function p(){return(0,u.o)(d)}var f=(0,a.nZ)({key:"datasetDefinitionSelector",get:function(){var e=(0,i.Z)(o().mark((function e(t){var n,r,i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.get,r=n(c.k),r.projectId,i=r.datasetId,r.predesign,n(d),a=n(s.Yy),!i||!a){e.next=16;break}if("predesign"!==i){e.next=11;break}return e.next=8,(0,l.FR)(a);case 8:return e.abrupt("return",e.sent);case 11:return e.next=13,(0,l.WB)(i,a);case 13:return e.abrupt("return",e.sent);case 14:e.next=17;break;case 16:return e.abrupt("return",null);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()});function g(){return(0,u.ot)(f)}var m={predesign:"predesign",es:"es",earlyStage:"es"},v=(0,a.nZ)({key:"datasetTypeSelector",get:function(e){var t=(0,e.get)(f);return null!==t&&void 0!==t&&t.typeId?m[t.typeId]:null}});function h(){return(0,u.o)(v)}function b(){return h()===m.predesign}var y=(0,a.nZ)({key:"referenceDefinitionSelector",get:function(){var e=(0,i.Z)(o().mark((function e(t){var n,r,i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.get,r=n(v)){e.next=4;break}return e.abrupt("return",null);case 4:if(i=n(f)){e.next=7;break}return e.abrupt("return",null);case 7:if(r!==m.predesign){e.next=20;break}if(a=n(s.Yy),!i.referenceDatasetId||!a){e.next=16;break}return console.log("Fetching reference!"),e.next=13,(0,l.WB)(i.referenceDatasetId,a);case 13:return e.abrupt("return",e.sent);case 16:return console.error("No referenceDatasetId!"),e.abrupt("return",null);case 18:e.next=22;break;case 20:if(r!==m.earlyStage){e.next=22;break}return e.abrupt("return",i);case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()});function k(){return(0,u.ot)(y)}var x=(0,a.nZ)({key:"availableVersionsState",get:function(e){var t=e.get,n=(t(v),t(y));return(null===n||void 0===n?void 0:n.versionHistory)||[]}});function Z(){return(0,u.o)(x)}var w=(0,a.cn)({key:"_selectedVersionAtom",default:null}),C=(0,a.nZ)({key:"selectedVersionState",get:function(e){var t=e.get,n=t(x),r=t(w);return!r&&(null===n||void 0===n?void 0:n.length)>0?n[0]:r},set:function(e,t){return(0,e.set)(w,t)}});function j(){return(0,u.o)(C)}function O(){return(0,u.Lx)(C)}var P=(0,a.nZ)({key:"selectedVersionFieldLookupState",get:function(e){var t,n,r=(0,e.get)(C);return r?(t=r.fieldInfo,n="fieldUniqueName",t.reduce((function(e,t){return e[t[n]]=t,e}),{})):{}}});function S(){return(0,u.o)(P)}},20563:function(e,t,n){"use strict";n.d(t,{q:function(){return i},v:function(){return a}});var r=n(64121),o=(n(67294),n(2804)),i=(0,o.cn)({key:"datasetFilterAtom",default:new Map});function a(){var e=(0,o.FV)(i),t=(0,r.Z)(e,2);return[t[0],t[1]]}},6546:function(e,t,n){"use strict";n.d(t,{R:function(){return i},x:function(){return a}});var r=n(64121),o=(n(67294),n(2804)),i=(0,o.cn)({key:"datasetFilterByBookmarkedAtom",default:{showBookmarks:!1}});function a(){var e=(0,o.FV)(i),t=(0,r.Z)(e,2);return[t[0],t[1]]}},86817:function(e,t,n){"use strict";n.d(t,{N9:function(){return b}});var r=n(64121),o=n(26265),i=(n(67294),n(2804)),a=n(30582),s=n(44689),c=n(20563),l=n(6546),u=n(84176),d=n(20764),p=n(13138);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m={number:{key:"number",within:function(e,t){return e>=t[0]&&e<=t[1]},extent:d.Wem},text:{key:"text",within:function(e,t,n){return t[0]<=n.scale(e)&&n.scale(e)<=t[1]},extent:function(e){return e.sort()}},date:{key:"date",within:function(e,t,n){return t[0]<=n.scale(e)&&n.scale(e)<=t[1]},extent:d.Wem}},v=function(e,t){return e&&e.map((function(e){var n=t.filter((function(e){return"number"===e.fieldType})).filter((function(t){return!m[t.fieldType].within(e[t.fieldUniqueName],[t.min,t.max])}));return g(g({},e),{},{preFilterRangeViolations:n,hasPreFilterRangeViolations:n.length>0})}))},h=(0,i.nZ)({key:"filteredDataset",get:function(e){var t=e.get,n=t(a.q),o=t(c.q),i=t(l.R),d=t(u.$),p=t(s.or),f=null!==p&&void 0!==p&&p.fieldInfo&&n?p.fieldInfo.filter((function(e){return"text"!==e.fieldType&&"fileReference"!==e.fieldType})).map((function(e){var t,r,o,i=g({},e),a=null===n||void 0===n||null===(t=n.serverFilter)||void 0===t?void 0:t.get(e.fieldUniqueName);a&&("number"===a.fieldType&&(i.min=null===(r=a.value)||void 0===r?void 0:r[0],i.max=null===(o=a.value)||void 0===o?void 0:o[1]));return i})):[];return i.showBookmarks?{response:v(d,f),inProgress:!1,error:!1,dimensions:f}:{response:n&&n.response&&n.response.filter((function(e){return Array.from(o).every((function(t){var n=(0,r.Z)(t,2),o=n[0],i=(0,r.Z)(n[1],2),a=i[0],s=i[1],c=null===p||void 0===p?void 0:p.fieldInfo.find((function(e){return e.fieldUniqueName===o}));return m[c.fieldType].within(e[o],[a,s])}))})),inProgress:!1,error:!1,dimensions:f}}});function b(){return(0,p.o)(h)}},55869:function(e,t,n){"use strict";n.d(t,{S:function(){return k},g:function(){return Z}});var r=n(809),o=n.n(r),i=n(26265),a=n(92447),s=n(64121),c=n(67294),l=(n(2804),n(58364)),u=n(57460),d=n.n(u);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e,t,n,r){return new Promise((function(o,a,s){console.log("beginning dataset analysis"),console.log(e),console.log(t);var c={};t.forEach((function(e){c[e.name]=e}));var l={};try{d().parse(e,{header:!0,dynamicTyping:!0,skipEmptyLines:!0,step:function(e){},transform:function(e,t){if(l[t]||(l[t]={possibleNumber:!0,possibleImage:!1}),e){var n=Number.parseFloat(e);return n||(l[t].possibleNumber=!1,c[e]&&(l[t].possibleImage=!0),e)}},complete:function(){console.log("done parsing");var e=function(e,t){var n=[],r=t?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t):null,o=[],a=[];for(var s in e){var c=e[s],l=c.possibleNumber?"number":c.possibleImage?"fileReference":"text",u={name:s,type:l};if(r){var d=!1,f=!1,g=r[s];g?(u.existingType=g.fieldType,delete r[s],g.fieldType!==l&&(a.push(s),f=!0)):(o.push(s),d=!0),(d||f)&&(u.errors={extraFieldError:d,fieldTypeError:f})}n.push(u)}var m=[];for(key in r)m.push(key);console.log(o),console.log(a),console.log(m),console.log(n);var v=o.length>0||a.length>0||m.length>0?{extraFieldErrors:o,fieldTypeErrors:a,missingFieldErrors:m}:null;return{fieldResults:n,errors:v}}(l,r),t=e.fieldResults,a=e.errors,s={existingDatasetId:n,fields:t,errors:a};console.log(l),console.log(s),o(s)},error:function(e,t){console.log(e),a(e)}})}catch(u){a(u)}}))}var g=n(15894),m=(n(9650),n(18065)),v=n(44689);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y={dataset:{files:[]},scanning:!1,scanResults:null,scanError:null,uploading:!1,uploadingResponse:!1,uploadingError:!1},k="___fIP4f00206d-1464__";function x(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o={},i={},a=Object.keys(e),s=0;s<a.length;s++){var c=a[s],l=e[c],u=c.split(t);u[1]?i[u[1]]=l:o[c]=l}return console.log(o),console.log(i),o[n]=r?JSON.stringify(i):i,console.log(o),o}function Z(){var e=(0,c.useState)(y),t=e[0],n=e[1],r=(0,l.dQ)(),i=(0,s.Z)(r,3),u=i[0],d=(i[1],i[2],(0,v.Rs)()),p=(0,v.GF)(),h=(0,s.Z)(p,1)[0],Z=(0,v.Q9)();function w(){return(w=(0,a.Z)(o().mark((function e(r){var i,a,s,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.info("uploading dataset"),e.prev=1,n(b(b({},t),{},{uploading:!0,uploadingError:null,uploadingResults:null})),a=x(r,k,"fieldInfo",!0),h&&Z&&(a.createMinorVersion=!0,a.majorVersionId=Z._id,a.existingDatasetId=h._id),h&&!Z&&(a.existingDatasetId=h._id),console.log("separatedFormData"),console.log(a),s=(0,m.Z)(a,{dataset:!0}),e.next=11,(0,g.JM)(u,s);case 11:if(c=e.sent,console.log(c),null===c||void 0===c||null===(i=c.response)||void 0===i||!i.definition){e.next=17;break}n(b(b({},t),{},{uploading:!1,uploadingError:null,uploadingResults:c})),e.next=18;break;case 17:throw Error("Upload appeared successful but no definition returned.");case 18:e.next=25;break;case 20:e.prev=20,e.t0=e.catch(1),console.log("upload error"),console.log(e.t0),n(b(b({},t),{},{uploading:!1,uploadingError:e.t0,uploadingResults:null}));case 25:case"end":return e.stop()}}),e,null,[[1,20]])})))).apply(this,arguments)}function C(){return(C=(0,a.Z)(o().mark((function e(r){var i,a,s,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.info("scanning dataset files"),e.prev=1,n(b(b({},t),{},{scanning:!0})),i=r.dataset,a=null,s=[],i.forEach((function(e){if("csv"===e.extension){if(a)throw Error("Multiple csv files included, please include only one.");a=e}else s.push(e)})),e.next=9,f(a,s,null===h||void 0===h?void 0:h._id,d);case 9:c=e.sent,n(b(b({},t),{},{scanning:!1,scanResults:c,scanError:null})),e.next=18;break;case 13:e.prev=13,e.t0=e.catch(1),console.log("scan error"),console.log(e.t0),n(b(b({},t),{},{scanning:!1,scanResults:null,scanError:e.t0}));case 18:case"end":return e.stop()}}),e,null,[[1,13]])})))).apply(this,arguments)}return console.log("existingDefinition"),console.log(h),[t.dataset,function(){n(y)},function(e){return C.apply(this,arguments)},t.scanning,t.scanResults,t.scanError,function(e){return w.apply(this,arguments)},t.uploading,t.uploadingResults,t.uploadingError]}},58840:function(e,t,n){"use strict";n.d(t,{UV:function(){return c},qn:function(){return u},Xw:function(){return p}});var r=n(64121),o=n(67294),i=n(2804),a=n(86817),s=(0,i.cn)({key:"datasetPageAtom",default:0});function c(){var e=(0,i.FV)(s),t=(0,r.Z)(e,2);return[t[0],t[1]]}var l=(0,i.cn)({key:"datasetRowsPerPageAtom",default:10});function u(){var e=(0,i.FV)(l),t=(0,r.Z)(e,2);return[t[0],t[1]]}var d=(0,i.cn)({key:"pagedDatasetAtom",default:{response:!1,totalCount:0,inProgress:!1,error:!1}});function p(){var e=(0,a.N9)(),t=(0,i.sJ)(s),n=(0,i.sJ)(l),c=(0,i.FV)(d),u=(0,r.Z)(c,2),p=u[0],f=u[1];return(0,o.useEffect)((function(){f({response:[],inProgress:!0}),e&&e.response&&f({response:e.response.slice(t*n,t*n+n),totalCount:e.response.length,inProgress:!1,error:!1})}),[e,t,n]),[p.response,p.totalCount,p.inProgress,p.error]}},67095:function(e,t,n){"use strict";n.d(t,{P:function(){return m}});var r=n(809),o=n.n(r),i=n(26265),a=n(92447),s=n(64121),c=n(67294),l=n(2804),u=n(58364),d=n(25639);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g=(0,l.cn)({key:"projectAtom",default:{response:!1,inProgress:!1,error:!1}});function m(e){var t=(0,l.FV)(g),n=(0,s.Z)(t,2),r=n[0],i=n[1],p=(0,u.dQ)(),m=(0,s.Z)(p,3),v=m[0],h=(m[1],m[2],"new"===e);return(0,c.useEffect)((function(){!v||!e||h||r.response&&r.response._id+""===e||r.error||r.inProgress||function(){var t=(0,a.Z)(o().mark((function t(){var n,a;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i(f(f({},r),{},{inProgress:!0})),t.next=4,(0,d.GG)(v,e);case 4:if(!((n=t.sent).length>1)){t.next=7;break}throw Error("Error, too many projects matched that id.");case 7:if(a=n&&1===n.length?n[0]:null){t.next=10;break}throw Error("Project ");case 10:if(null!==a&&void 0!==a&&a._id){t.next=12;break}throw Error("response didn't include project id");case 12:i({response:a,inProgress:!1}),t.next=20;break;case 15:t.prev=15,t.t0=t.catch(0),console.error("useProject error"),console.error(t.t0),i({error:t.t0,inProgress:!1});case 20:case"end":return t.stop()}}),t,null,[[0,15]])})));return function(){return t.apply(this,arguments)}}()()}),[v,r,e,h]),[r.response,r.inProgress,r.error,h]}},78966:function(e,t,n){"use strict";n.d(t,{v:function(){return a},Y:function(){return c}});var r=n(64121),o=(n(67294),n(2804)),i=(0,o.cn)({key:"selectedAtom",default:null});function a(){var e=(0,o.FV)(i),t=(0,r.Z)(e,2);return[t[0],t[1]]}var s=(0,o.cn)({key:"hoveredAtom",default:null});function c(){var e=(0,o.FV)(s),t=(0,r.Z)(e,2);return[t[0],t[1]]}}}]);